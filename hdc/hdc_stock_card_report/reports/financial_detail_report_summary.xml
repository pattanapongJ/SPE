<odoo>

    <template
        id="assets_backend"
        name="hdc_financial_detail_summary_report assets"
        inherit_id="web.assets_backend"
    >
        <xpath expr="." position="inside">
            <link
                href="/hdc_stock_card_report/static/src/css/report.css"
                rel="stylesheet"
            />
            <script
                type="text/javascript"
                src="/hdc_stock_card_report/static/src/js/stock_card_report_backend.js"
            />
        </xpath>
    </template>

    <template id="hdc_stock_card_report.financial_detail_summary_internal_layout">
        <div class="article">
            <link
                href="/hdc_stock_card_report/static/src/css/report.css"
                rel="stylesheet"
            />
            <t t-raw="0" />
        </div>
        <div class="footer">
            <div class="row">
                <div class="col-6 custom_footer">
                    <span
                        t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d')"
                    />
                </div>
                <div class="col-6 text-right custom_footer">
                    <span class="page" />/<span class="topage" />
                </div>
            </div>
        </div>
    </template>

    <template id="report_financial_detail_summary_buttons">
        <div class="button_row">
            <!-- <button class="o_stock_card_reports_print btn btn-sm oe_button"><span
                    class="fa fa-print"
                />Print</button> -->
            <button class="o_stock_card_reports_export btn btn-sm oe_button"><span
                    class="fa fa-print"
                />Print</button>
            <button class="o_stock_card_reports_export btn btn-sm oe_button"><span
                    class="fa fa-download"
                />Export</button>
        </div>
    </template>

    <template id="report_financial_detail_report_summary_html">
        <div class="o_stock_card_reports_page">
            <t t-call="hdc_stock_card_report.report_financial_detail_summary_buttons" />
            <t t-call="hdc_stock_card_report.report_financial_detail_report_summary_base" />
        </div>
    </template>

    <template id="hdc_stock_card_report.report_financial_detail_report_summary_pdf">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="hdc_stock_card_report.internal_layout">
                    <t t-call="hdc_stock_card_report.report_financial_detail_report_summary_base" />
                </t>
            </t>
        </t>
    </template>

    <template id="hdc_stock_card_report.report_financial_detail_report_summary_base">        
            <div class="page">      
                <div class="row">
                    <t t-set="title">SPE Stock card - Financial (Detail) Summary</t>                  
                    <h4 class="mt0" t-esc="title" style="text-align: center;" />
                </div>    
                 
                <!-- Display filters -->
                <t t-call="hdc_stock_card_report.report_financial_detail_report_summary_filters" />
                <!-- Display stock card table -->
                <div class="act_as_table data_table mt4" style="width: 100%;">
                    <!-- Display header line-->
                    <t t-call="hdc_stock_card_report.report_financial_detail_summary_lines_header" />
                    <!-- Display each lines -->
                    <t t-set="first_product" t-value="1"/>
                    <t t-set="check_product" t-value=""/>
                    <t t-set="before_total_qty" t-value="0"/>
                    <t t-set="before_total_price" t-value="0"/>
                    <t t-set="internal_total_qty" t-value="0"/>
                    <t t-set="internal_total_price" t-value="0"/>
                    <t t-set="transit_total_qty" t-value="0"/>
                    <t t-set="transit_total_price" t-value="0"/>
                    <t t-set="amount_total" t-value="0"/>
                    <t t-set="amount_total_price" t-value="0"/>
                    <t t-set="grand_before_total" t-value="0"/>
                    <t t-set="grand_before_total_price" t-value="0"/>
                    <t t-set="grand_internal_total" t-value="0"/>
                    <t t-set="grand_internal_total_price" t-value="0"/>
                    <t t-set="grand_transit_total" t-value="0"/>
                    <t t-set="grand_transit_total_price" t-value="0"/>
                    <t t-set="grand_amount_total" t-value="0"/>
                    <t t-set="grand_amount_total_price" t-value="0"/>
                    <t t-foreach="o.results" t-as="product_line">
                        <t t-if="first_product != 1">
                            <t t-set="grand_before_total" t-value="grand_before_total + before_total_qty"/>
                            <t t-set="grand_before_total_price" t-value="grand_before_total_price + before_total_price"/>
                            <t t-set="grand_internal_total" t-value="grand_internal_total + internal_total_qty"/>
                            <t t-set="grand_internal_total_price" t-value="grand_internal_total_price + internal_total_price"/>
                            <t t-set="grand_transit_total" t-value="grand_transit_total + transit_total_qty"/>
                            <t t-set="grand_transit_total_price" t-value="grand_transit_total_price + transit_total_price"/>
                            <t t-set="grand_amount_total" t-value="grand_amount_total + amount_total"/>
                            <t t-set="grand_amount_total_price" t-value="grand_amount_total_price + amount_total_price"/>
                            <t t-set="before_total_qty" t-value="0"/>
                            <t t-set="before_total_price" t-value="0"/>
                            <t t-set="internal_total_qty" t-value="0"/>
                            <t t-set="internal_total_price" t-value="0"/>
                            <t t-set="transit_total_qty" t-value="0"/>
                            <t t-set="transit_total_price" t-value="0"/>
                        </t>
                        <t t-if="first_product == 1">
                            <t t-set="first_product" t-value="0"/>
                        </t>
                        <div class="act_as_row lines">
                            <div class="act_as_cell left">
                                <t t-esc="product_line.default_code" />
                            </div>
                            <div class="act_as_cell left">
                                <t t-esc="product_line.product_id.name" />
                            </div>
                            <div class="act_as_cell right">
                                <t t-esc="product_line.product_uom_id.name" />
                            </div>
                            <div class="act_as_cell right">
                                <t t-esc="product_line.location_dest_id.complete_name" />
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_available">
                                    <t t-esc="'{0:,.2f}'.format(product_line.qty_available)" />
                                    <t t-set="before_total_qty" t-value="before_total_qty + product_line.qty_available"/>                                 
                                </t>
                                <t t-if="not product_line.qty_available">
                                    
                                </t>     
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_available">
                                    <t t-if="product_line.amount_unit_price">
                                        <t t-esc="'{0:,.2f}'.format(product_line.amount_unit_price)" />
                                    </t>
                                    <t t-if="not product_line.amount_unit_price">
                                        
                                    </t>         
                                </t>  
                                <t t-if="not product_line.qty_available">
                                    
                                </t>                           
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_available">
                                    <t t-if="product_line.amount_unit_price">
                                        <t t-esc="'{0:,.2f}'.format(product_line.amount_unit_price * product_line.qty_available)" />
                                        <t t-set="before_total_price" t-value="before_total_price + (product_line.amount_unit_price * product_line.qty_available)"/>
                                    </t>
                                    <t t-if="not product_line.amount_unit_price">
                                        
                                    </t>         
                                </t>   
                                <t t-if="not product_line.qty_available">
                                    
                                </t>                    
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_in">
                                    <t t-esc="'{0:,.2f}'.format(product_line.qty_in)" />
                                    <t t-set="internal_total_qty" t-value="internal_total_qty + product_line.qty_in"/>
                                </t>
                                <t t-if="not product_line.qty_in">
                                    
                                </t>                                    
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.in_unit_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.in_unit_price)" />
                                </t>
                                <t t-if="not product_line.in_unit_price">
                                    
                                </t>                                    
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.in_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.in_price)" />
                                    <t t-set="internal_total_price" t-value="internal_total_price + product_line.in_price"/>
                                </t>
                                <t t-if="not product_line.qty_in">
                                    
                                </t>                                    
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_out">
                                    <t t-esc="'{0:,.2f}'.format(product_line.qty_out)" />
                                    <t t-set="transit_total_qty" t-value="transit_total_qty + product_line.qty_out"/>
                                </t>
                                <t t-if="not product_line.qty_out">
                                    
                                </t>        
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.out_unit_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.out_unit_price)" />
                                </t>
                                <t t-if="not product_line.qty_out">
                                    
                                </t>        
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.out_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.out_price)" />
                                    <t t-set="transit_total_price" t-value="transit_total_price + product_line.out_price"/>
                                </t>
                                <t t-if="not product_line.qty_out">
                                    
                                </t>        
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.amount_qty">
                                    <t t-esc="'{0:,.2f}'.format(product_line.amount_qty)" />
                                    <t t-set="amount_total" t-value="product_line.amount_qty"/>
                                </t>
                                <t t-if="not product_line.amount_qty">
                                    <t t-set="amount_total" t-value="0"/>
                                    
                                </t>        
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.amount_qty">
                                    <t t-if="product_line.amount_unit_price">
                                        <t t-esc="'{0:,.2f}'.format(product_line.amount_unit_price)" />
                                    </t>
                                    <t t-if="not product_line.amount_unit_price">
                                        
                                    </t>      
                                </t>
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.amount_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.amount_price)" />
                                </t>
                                <t t-if="not product_line.amount_price">
                                    
                                </t>        
                            </div>
                            <t t-set="amount_total_price" t-value="product_line.amount_qty * product_line.amount_unit_price"/>
                        </div> 
                        <div class="act_as_row lines">
                            <div class="act_as_cell left"></div>
                            <div class="act_as_cell left"></div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right">Total</div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_in">
                                    <t t-esc="'{0:,.2f}'.format(product_line.qty_in)" />
                                </t>
                                <t t-if="not product_line.qty_in">
                                    <t t-esc="'{0:,.2f}'.format(0)" />
                                </t>                                    
                            </div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.in_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.in_price)" />
                                </t>
                                <t t-if="not product_line.qty_in">
                                    <t t-esc="'{0:,.2f}'.format(0)" />
                                </t>                                    
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.qty_out">
                                    <t t-esc="'{0:,.2f}'.format(product_line.qty_out)" />
                                </t>
                                <t t-if="not product_line.qty_out">
                                    <t t-esc="'{0:,.2f}'.format(0)" />
                                </t>        
                            </div>
                            <div class="act_as_cell right"> </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.out_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.out_price)" />
                                </t>
                                <t t-if="not product_line.qty_out">
                                    0
                                </t>        
                            </div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.amount_qty">
                                    <t t-esc="'{0:,.2f}'.format(product_line.amount_qty)" />
                                </t>
                                <t t-if="not product_line.amount_qty">
                                    0
                                </t>        
                            </div>
                            <div class="act_as_cell right"></div>
                            <div class="act_as_cell right">
                                <t t-if="product_line.amount_price">
                                    <t t-esc="'{0:,.2f}'.format(product_line.amount_price)" />
                                </t>
                                <t t-if="not product_line.amount_price">
                                    0
                                </t>        
                            </div>     
                        </div> 
                    </t>
                    <t t-set="grand_before_total" t-value="grand_before_total + before_total_qty"/>
                    <t t-set="grand_before_total_price" t-value="grand_before_total_price + before_total_price"/>
                    <t t-set="grand_internal_total" t-value="grand_internal_total + internal_total_qty"/>
                    <t t-set="grand_internal_total_price" t-value="grand_internal_total_price + internal_total_price"/>
                    <t t-set="grand_transit_total" t-value="grand_transit_total + transit_total_qty"/>
                    <t t-set="grand_transit_total_price" t-value="grand_transit_total_price + transit_total_price"/>
                    <t t-set="grand_amount_total" t-value="grand_amount_total + amount_total"/>
                    <t t-set="grand_amount_total_price" t-value="grand_amount_total_price + amount_total_price"/>
                    <div class="act_as_row lines">
                        <div class="act_as_cell"></div>
                        <div class="act_as_cell left" style="background-color:#92D050;"><b>GRAND TOTAL</b></div>
                        <div class="act_as_cell"></div>
                        <div class="act_as_cell"></div>
                        <div class="act_as_cell right">
                            <t t-if="grand_before_total">
                                <t t-esc="'{0:,.2f}'.format(grand_before_total)"/>
                            </t>
                            <t t-if="not grand_before_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_before_total > 0">
                                <t t-esc="'{0:,.2f}'.format(grand_before_total_price / grand_before_total)"/>
                            </t>
                            <t t-if="not grand_before_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_before_total_price">
                                <t t-esc="'{0:,.2f}'.format(grand_before_total_price)"/>
                            </t>
                            <t t-if="not grand_before_total_price">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_internal_total">
                                <t t-esc="'{0:,.2f}'.format(grand_internal_total)"/>
                            </t>
                            <t t-if="not grand_internal_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_internal_total > 0">
                                <t t-esc="'{0:,.2f}'.format(grand_internal_total_price / grand_internal_total)"/>
                            </t>
                            <t t-if="not grand_internal_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_internal_total_price">
                                <t t-esc="'{0:,.2f}'.format(grand_internal_total_price)"/>
                            </t>
                            <t t-if="not grand_internal_total_price">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_transit_total">
                                <t t-esc="'{0:,.2f}'.format(grand_transit_total)"/>
                            </t>
                            <t t-if="not grand_transit_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_transit_total > 0">
                                <t t-esc="'{0:,.2f}'.format(grand_transit_total_price / grand_transit_total)"/>
                            </t>
                            <t t-if="not grand_transit_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_transit_total_price">
                                <t t-esc="'{0:,.2f}'.format(grand_transit_total_price)"/>
                            </t>
                            <t t-if="not grand_transit_total_price">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_amount_total">
                                <t t-esc="'{0:,.2f}'.format(grand_amount_total)"/>
                            </t>
                            <t t-if="not grand_amount_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_amount_total > 0">
                                <t t-esc="'{0:,.2f}'.format(grand_amount_total_price / grand_amount_total)"/>
                            </t>
                            <t t-if="not grand_amount_total">
                                0
                            </t>  
                        </div>
                        <div class="act_as_cell right">
                            <t t-if="grand_amount_total_price">
                                <t t-esc="'{0:,.2f}'.format(grand_amount_total_price)"/>
                            </t>
                            <t t-if="not grand_amount_total_price">
                                0
                            </t>  
                        </div>
                    </div>
                </div>
                <p style="page-break-before:always;" />
            </div>
    </template>

    <template id="hdc_stock_card_report.report_financial_detail_report_summary_filters">
        <div class="act_as_table data_table" style="width: 100%;">
            <div class="act_as_row labels">
                <div class="act_as_cell">Date From</div>
                <div class="act_as_cell">Date To</div>
                <div class="act_as_cell">Warehouse</div>
                <div class="act_as_cell">Location</div>
            </div>
            <div class="act_as_row">
                <div class="act_as_cell">
                    <span t-field="o.date_from" />
                </div>
                <div class="act_as_cell">
                    <span t-field="o.date_to" />
                </div>
                <div class="act_as_cell">
                    <span t-field="o.warehouse_ids" />
                </div>
                <div class="act_as_cell">
                    <span t-field="o.location_ids" />
                </div>
            </div>
        </div>
    </template>

    <template id="hdc_stock_card_report.report_financial_detail_summary_lines_header">
        <div class="act_as_thead">
            <div class="act_as_row">
                <div class="act_as_cell_borderless"></div>
                <div class="act_as_cell_borderless"></div>
                <div class="act_as_cell_borderless"></div>
                <div class="act_as_cell_borderless"></div>
                <div class="act_as_cell_left"></div>
                <div class="act_as_cell_top_bot">ยอดยกมา</div>
                <div class="act_as_cell_right"></div>
                <div class="act_as_cell_left"></div>
                <div class="act_as_cell_top_bot">รับเข้า</div>
                <div class="act_as_cell_right"></div>
                <div class="act_as_cell_left"></div>
                <div class="act_as_cell_top_bot">จ่ายออก</div>
                <div class="act_as_cell_right"></div>
                <div class="act_as_cell_left"></div>
                <div class="act_as_cell_top_bot">ยอดคงเหลือ</div>
                <div class="act_as_cell_right"></div>
            </div>
            <div class="act_as_row labels">
                <div class="act_as_cell">รหัสสินค้า</div>
                <div class="act_as_cell">ชื่อสินค้า</div>
                <div class="act_as_cell">หน่วย</div>
                <div class="act_as_cell">Config</div>
                <div class="act_as_cell">จำนวน</div>
                <div class="act_as_cell">ราคา-หน่วย</div>
                <div class="act_as_cell">มูลค่า</div>
                <div class="act_as_cell">จำนวน</div>
                <div class="act_as_cell">ราคา-หน่วย</div>
                <div class="act_as_cell">มูลค่า</div>
                <div class="act_as_cell">จำนวน</div>
                <div class="act_as_cell">ราคา-หน่วย</div>
                <div class="act_as_cell">มูลค่า</div>
                <div class="act_as_cell">จำนวน</div>
                <div class="act_as_cell">ราคา-หน่วย</div>
                <div class="act_as_cell">มูลค่า</div>
            </div>
        </div>
    </template>
</odoo>
