<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="inter_company_transactions_sale_order_type_form_inherit" model="ir.ui.view">
        <field name="name">inter.company.transactions.sale.order.type.form.inherit</field>
        <field name="model">sale.order.type</field>
        <field name="inherit_id" ref="sale_order_type.sot_sale_order_type_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//group[2]/group[1]" position="inside">
                <field name="inter_company_transactions"/>
                <field name="inter_company_transactions_type" attrs="{'required': [('inter_company_transactions', '=', True)],'invisible':[('inter_company_transactions', '=', False)]}"/>
            </xpath>
            <xpath expr="//field[@name='pricelist_id']" position="replace">
                <field
                    name="pricelist_id"
                    groups="product.group_product_pricelist" attrs="{'required': [('inter_company_transactions', '=', True)]}"/>
            </xpath>
        </field>
    </record>

    <record id="inter_company_transactions_sale_order_form_inherit" model="ir.ui.view">
        <field name="name">inter.company.transactions.sale.order.form.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_order_type.sot_view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='type_id']" position="replace">
                <!-- <field name="type_id" string="Sales Type" required="1" domain="['|', ('id', 'in', sale_type_ids),('inter_company_transactions', '=', True),('company_id','=',company_id)]"/> -->
                <field name="type_id" string="Sales Type" required="1"/>
            </xpath>
        </field>
    </record>

    <record id="inter_company_transactions_sale_order_confirm_form_inherit" model="ir.ui.view">
        <field name="name">inter.company.transactions.sale.order.confirm.form.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="dev_customer_credit_limit.view_sale_order_confirm_inherit_form"/>
        <field name="arch" type="xml">
            <!-- button[@name='action_sale_ok'] have 2 button -->
            <xpath expr="//button[@name='action_sale_ok']" position="attributes">
                <attribute name="name">action_sale_ok2</attribute>
            </xpath>
            <xpath expr="//button[@name='action_sale_ok']" position="attributes">
                <attribute name="name">action_sale_ok2</attribute>
            </xpath>
        </field>
    </record>

    <record id="hdc_transactions_order_form_inherit" model="ir.ui.view">
        <field name="name">sale.order.form</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="hdc_sale.hdc_sale_view_order_form_inherit"/>
        <field name="arch" type="xml">

            <xpath expr="//button[@name='preview_sale_order']" position="before">
                <field name="inter_so_company" invisible="1"/>
                <field name="inter_so_company_count" invisible="1"/>
                <field name="inter_po_company_count" invisible="1"/>
                <button name="action_so_inter_company" type="object" class="oe_stat_button" icon="fa-file-text-o"
                        attrs="{'invisible': [
                        '|',
                        ('inter_so_company_count', '=', 0),
                        ('inter_company_transactions', '=', True),
                        ]}">
                    <field name="count_so_inter" widget="statinfo" string="SO Inter Company"/>
                </button>
                <button name="action_po_inter_company" type="object" class="oe_stat_button" icon="fa-file-text-o"
                        attrs="{'invisible': [('inter_po_company_count', '=', 0)]}">
                    <span class="o_stat_text">PO Inter Company</span>
                </button>
            </xpath>

            <xpath expr="//button[@name='action_cancel']" position="after">
                <button name="action_inter_company" type="object" string="Create Inter Company" class="oe_highlight"
                    attrs="{'invisible': [
                    '|',
                    ('state', 'in', ('sale','done','cancel')),
                    ('inter_company_transactions', '=', False),
                    ]}"/>

                <button name="action_inter_company" type="object" string="Create Inter Company" class="oe_highlight"
                    attrs="{'invisible': [
                    '|',
                    ('state', 'not in', ('sale','done')),
                    ('inter_company_transactions', '=', True),

                    ]}"/>
            </xpath>
            <xpath expr="//field[@name='delivery_trl']" position="replace">
                <field name="inter_company_transactions" invisible="1"/>
                <field name="delivery_trl" attrs="{'readonly': [('state', 'in', ('sale','done','cancel'))], 'required': [('inter_company_transactions', '!=', True)]}" domain="[('status_active', '=', True)]"/>
            </xpath>
            <xpath expr="//field[@name='delivery_trl_description']" position="replace">
                <field name="delivery_trl_description" attrs="{'readonly': [('state', 'in', ('sale','done','cancel'))], 'required': [('inter_company_transactions', '!=', True)]}"/>
            </xpath>
            <xpath expr="//field[@name='delivery_company']" position="replace">
                <field name="delivery_company" string="Mode of delivery" attrs="{'readonly': [('state', 'in', ('sale','done','cancel'))], 'required': [('inter_company_transactions', '!=', True)]}" domain="[('status_active', '=', True)]"/>
            </xpath>
            <xpath expr="//field[@name='delivery_company_description']" position="replace">
               <field name="delivery_company_description" string="Mode of delivery Description" attrs="{'readonly': [('state', 'in', ('sale','done','cancel'))], 'required': [('inter_company_transactions', '!=', True)]}"/>
            </xpath>
        </field>
    </record>

</odoo>
