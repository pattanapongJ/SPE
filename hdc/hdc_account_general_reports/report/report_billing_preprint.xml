<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_billing_preprint_document">
        <t t-name="hdc_account_general_reports.report_billing_preprint_document">
            <t t-if="not o and doc">
                <t t-set="o" t-value="doc"/>
        </t>
            <t t-if="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
            <t t-if="not o or not 'company_id' in o">
                <t t-set="company" t-value="res_company"/>
        </t>
            <t t-set="amount_total" t-value="0"/>
            <div class="header" style="font-family: KanitLight; font-size: 13pt;">
                <br/>
                <div class="row" style="position: relative; top: -32px;">
                    <div class="col-9 text-right">
                        <span>
                            <t t-if="o.billing_line_ids">
                                <br/>
                                <t t-esc="o.billing_line_ids[0].invoice_id.billing_period_id.code"/>
                      </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                    <div class="col-3 text-right">
                        <span>
                            <t t-esc="o.form_no"/>
                            <br/>
                            <br/>
                        </span>
                    </div>
                    <div class="col-1"/>
           </div>
                <br/>
                <div class="row" style="font-size: 13pt;">
                    <div class="col-1"/>
                    <div class="col-4 text-left">
                        <span>
                            <t t-if="o.partner_id.name">
                                <t t-esc="o.partner_id.name"/>
                    </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                    <div class="col-7 text-left">
                        <span>
                            <t t-if="o.partner_id.is_head_office">
                                <t t-esc="o.partner_id.branch_name"/>
                    </t>
                            <t t-else="">
                                <span t-field="o.partner_id.branch_name"/>
                                <span> สาขาที่ </span>
                                <span t-field="o.partner_id.branch"/>
                            </t>
                        </span>
                    </div>
                </div>
                <div class="row" style="font-size: 13pt;">
                    <div class="col-6 text-break">
                        <span>
                            <span t-if="o.partner_id.street">
                                <span style="text-transform: capitalize" t-esc="o.partner_id.street"/>
                    </span>
                            <span t-if="o.partner_id.street2">
                                <span style="text-transform: capitalize" t-esc="o.partner_id.street2"/>
                    </span>
                            <span t-if="o.partner_id.sub_district">
                                <span style="text-transform: capitalize" t-esc="o.partner_id.sub_district"/>,
                    </span>
                            <span t-if="o.partner_id.city">
                                <span style="text-transform: capitalize" t-esc="o.partner_id.city"/>,
                    </span>
                            <span t-if="o.partner_id.state_id">
                                <span style="text-transform: capitalize" t-esc="o.partner_id.state_id.name"/>,
                    </span>
                            <span t-if="o.partner_id.zip">
                                <span t-esc="o.partner_id.zip"/>
                    </span>
                        </span>
                    </div>
                </div>
                <div class="row" style="font-size: 13pt;">
                    <div class="col-10">
                        <span>
                    เลขประจำตัวผู้เสียภาษี
                </span>
                        <span>
                            <t t-if="o.partner_id.vat">
                                <t t-esc="o.partner_id.vat"/>
                    </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                    <div class="col-4 text-left" style="margin-top: 25px;">
                        <span>
                            <t t-if="o.sales_person_id.name">
                                <t t-esc="o.sales_person_id.name"/>
                    </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                </div>
                <div class="row" style="margin-top: 15px; font-size: 13pt;">
                    <div class="col-12">
                        <span>
                    โทร
                </span>
                        <span>
                            <t t-if="o.partner_id.phone">
                                <t t-esc="o.partner_id.phone"/>
                    </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                        <span style="padding-left:8px;"> โทรสาร </span>
                        <span>
                            <t t-if="o.partner_id.fax">
                                <t t-esc="o.partner_id.fax"/>
                    </t>
                            <t t-else="">
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                    <!--<div class="col-4">-->
                    <!--    <span>-->
                    <!--        โทรสาร-->
                    <!--    </span>-->
                    <!--    <span>-->
                    <!--        <t t-if="o.partner_id.fax">-->
                    <!--            <t t-esc="o.partner_id.fax"/>-->
                    <!--        </t>-->
                    <!--        <t t-else="">-->
                    <!--            <span style="color: white;">-</span>-->
                    <!--        </t>-->
                    <!--    </span>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="article" style="font-family: KanitLight; font-size: 11pt;" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
                <style>
            thead th {
              height: 41px;
            }
          </style>
                <div class="row" style="margin-top:-5px;">
                    <t t-set="l_no" t-value="0"/>
                    <table class="table table-borderless mb-0">
                        <thead>
                            <tr>
                                <th class="text-center" style="width: 5%;color: white">1</th>
                                <th class="text-center" style="width: 15%;color: white">2</th>
                                <th class="text-center" style="width: 10%;color: white">3</th>
                                <th class="text-center" style="width: 25%;color: white">4</th>
                                <th class="text-center" style="width: 10%;color: white">5</th>
                                <th class="text-center" style="width: 35%;color: white">6</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="o.billing_line_ids.sorted(key=lambda l: (l.spe_invoice is False, l.spe_invoice or 0))" t-as="ol">
                                <td class="text-center" width="14%" style="padding-top: 2px; padding-bottom: 2px;">
                                    <t t-set="l_no" t-value="l_no + 1"/>
                                    <t t-esc="l_no"/>
                                </td>
                                <td class="text-center" style="padding-top: 2px; padding-bottom: 2px;">
                                    <t t-if="ol.invoice_date">
                                        <t t-esc="ol.invoice_date.strftime('%d/%m/%Y')"/>
                                    </t>
                                    <t t-else="">
                                        <span style="color: white;">-</span>
                                    </t>
                                </td>
                                <td class="text-left" style="padding-top: 2px; padding-bottom: 2px;">
                                    <t t-if="o.is_service">
                                        <t t-esc="ol.service"/>
                                    </t>
                                    <t t-else="">
                                        <t t-esc="ol.invoice_id.customer_po"/>
                                    </t>
                                </td>
                                <td class="text-center" style="padding-top: 2px; padding-bottom: 2px;">
                                    <t t-if="ol.invoice_id.form_no">
                                        <t t-esc="ol.invoice_id.form_no"/>
                                    </t>
                                    <t t-else="">
                                        <t t-esc="ol.invoice_id.name"/>
                                    </t>
                                </td>
                                <td class="text-right" style="padding-top: 2px; padding-bottom: 2px;">
                                    <t t-if="o.payment_terms_id.name">
                                        <t t-esc="o.payment_terms_id.name"/>
                                    </t>
                                    <t t-else="">
                                        <span style="color: white;">-</span>
                                    </t>
                                </td>
                                <td class="text-right" width="25%" style="padding-top: 2px; padding-bottom: 2px; padding-right:30px;">
                                    <t t-set="amount_total" t-value="amount_total + ol.total"/>
                                    <t t-esc="'{0:,.2f}'.format(float(ol.total))"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="footer last-page" style="font-family: KanitLight; font-size: 12pt;">
                <div class="row pt-3" style="font-size: 12pt;">
                    <div class="col-12" style="margin-left: 1cm;">
                        <span t-field="o.billing_remark"/>
                    </div>
                </div>
                <div class="row" style="font-size: 12pt;">
                    <div class="col-12" style="margin-left: 1cm;">
                        <div>
                            <span>
                          แผนกการเงิน  โทร 02-9381938
                      </span>
                            <span t-field="o.finance_contact_id.name"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12" style="margin-left: 1cm; font-size: 12pt;">
                  Email:
                        <span t-field="o.finance_contact_id.description"/>
                    </div>
                </div>
                <div class="row" style="margin-top: 5px; margin-bottom: 5px;">
                    <div class="col-12" style="font-size: 13pt; margin-left: 1cm;position: relative; top: 5px;">
                        <span>
                        (
                            <span t-esc="o.currency_id.amount_to_text_th(abs(amount_total), o.currency_id.currency_unit_label)"/>)
                    </span>
                    </div>
                </div>
                <div class="row" style="font-size: 12pt; position: relative; top: -24px;">
                    <div class="col-9"/>
                    <div class="col-3 text-right">
                        <span style="padding-right:30px;">
                            <t t-esc="'{0:,.2f}'.format(float(amount_total))"/>
                        </span>
                    </div>
                </div>
                <br/>
                <div class="row" style="position: relative; top: -30px;">
                    <div class="col-2">
                        <span>
                            <t t-if="o.batch_no">
                                <span t-field="o.batch_no"/>
                            </t>
                        </span>
                    </div>
                    <div class="col-8">
                        <span>
                            <t t-if="o.billing_line_ids and o.billing_line_ids[0].invoice_id and o.billing_line_ids[0].invoice_id.billing_period_id and o.billing_line_ids[0].invoice_id.billing_period_id.name">
                            BL:
                                <t t-esc="o.billing_line_ids[0].invoice_id.billing_period_id.name"/>
                        </t>
                            <t t-else="">
                            BL:
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                        <span style="padding-left:20px;">
                            <t t-if="o.billing_line_ids and o.billing_line_ids[0].invoice_id and o.billing_line_ids[0].invoice_id.billing_route_id and o.billing_line_ids[0].invoice_id.payment_period_id.name">
                            RE:
                                <t t-esc="o.billing_line_ids[0].invoice_id.payment_period_id.name"/>
                        </t>
                            <t t-else="">
                            RE:
                                <span style="color: white;">-</span>
                            </t>
                        </span>
                    </div>
                    <div class="col-2">
                        <span>
                            <t t-esc="o.payment_terms_id.name"/>
                        </span>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <div class="col-6 text-left" style="white-space: pre-line; position: relative; top: -55px;">
                        <span>
                            <t t-esc="company.billing_remark_th"/>
                        </span>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="report_billing_preprint">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="hdc_account_general_reports.report_billing_preprint_document" />
            </t>
        </t>
    </template>
</odoo>