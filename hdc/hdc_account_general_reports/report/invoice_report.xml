<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="MPF_invoice_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>

        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit" >
            <div class="row">
                <div class="col-7 text-left">
                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo.decode('ascii')" class="pull-left" style="max-height: 140px; max-width: 140px;"/>
                </div>
                <div class="col-5 text-right"  style="margin-right:0mm;margin-top:3mm">
                    <div style="font-size: 15px" >
                        <span>เอกสารออกเป็นชุด</span>
                    </div>
                    <div style="font-size: 25px" >
                        <span><strong>ใบแจ้งหนี้ (Invoice)</strong></span>
                    </div>
                    <div style="font-size: 15px" >
                        <span>ต้นฉบับ/Original</span>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top:3mm">
                <div class="col-7">
                    <div class="row">
                        <div class="col-12">
                            <span t-field="company.name"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span t-field="company.street"/>
                            <span t-field="company.street2"/>
                            <span t-field="company.sub_district"/>
                            <span t-field="company.city"/>
                            <span t-field="company.state_id.name"/>
                            <span t-field="company.zip"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            เลขประจำตัวผู้เสียภาษี: <span t-field="company.vat"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            โทร: <span t-field="company.phone"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            E-mail:
                            <t t-if="company.email">
                                    <span t-field="company.email"/>
                            </t>
                            <t t-else="">
                                    -
                            </t>

                            <t t-if="company.website">
                                    / <span t-field="company.website"/>
                            </t>
                            <t t-else="">
                                    -
                            </t>
                        </div>
                    </div>
                </div>
                <div class="col-5" style="background-color:#ECECEC">
                    <div class="row">
                        <div class="col-5">
                            <span><strong>เลขที่เอกสาร: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.name">
                               <span t-field="doc.name"/>
                           </span>
                           <span t-if="not doc.name">
                               -
                           </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>วันที่เอกสาร: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.invoice_date">
                               <span t-field="doc.invoice_date"/>
                            </span>
                            <span t-if="not doc.invoice_date">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>เงื่อนไขการชำระ: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.invoice_payment_term_id.name">
                               <span t-field="doc.invoice_payment_term_id.name"/>
                            </span>
                            <span t-if="not doc.invoice_payment_term_id.name">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>กำหนดชำระ: </strong></span>
                        </div>
                        <div class="col-7">
                             <span t-if="doc.invoice_date_due">
                               <span t-field="doc.invoice_date_due"/>
                            </span>
                            <span t-if="not doc.invoice_date_due">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>อ้างอิง: </strong></span>
                        </div>
                        <div class="col-7">
                             <span t-if="doc.payment_reference">
                               <span t-field="doc.payment_reference"/>
                            </span>
                            <span t-if="not doc.payment_reference">
                               -
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top:3mm;border-top: 1px solid black">
                <div class="col-7">
                    <div class="row">
                           <div class="col-3">
                               <span><strong>ลูกค้า: </strong></span>
                           </div>
                           <div class="col-9">
                               <span t-if="doc.partner_id.name">
                                   <span t-field="doc.partner_id.name"/>
                               </span>
                               <span t-if="not doc.partner_id.name">
                                   -
                               </span>
                           </div>
                       </div>
                    <div class="row">
                       <div class="col-3">
                           <span><strong>ที่อยู่: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.street">
                               <span t-field="doc.partner_id.street"/>
                           </span>
                           <span t-if="doc.partner_id.street2">
                               <span t-field="doc.partner_id.street2"/>
                           </span>
                           <span t-if="doc.partner_id.sub_district">
                               <span t-field="doc.partner_id.sub_district"/>
                           </span>
                           <span t-if="doc.partner_id.city">
                               <span t-field="doc.partner_id.city"/>
                           </span>
                           <span t-if="doc.partner_id.state_id.name">
                               <span t-field="doc.partner_id.state_id.name"/>
                           </span>
                           <span t-if="doc.partner_id.zip">
                               <span t-field="doc.partner_id.zip"/>
                           </span>
                       </div>
                   </div>
                     <div class="row">
                       <div class="col-3">
                           <span><strong>เลขที่ภาษี: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.vat">
                               <span t-field="doc.partner_id.vat"/>
                           </span>
                           <span t-if="not doc.partner_id.vat">
                               -
                           </span>
                       </div>
                   </div>
                    <div class="row">
                       <div class="col-3">
                           <span><strong>สาขา: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.branch">
                               <span t-field="doc.partner_id.branch"/>
                           </span>
                           <span t-if="not doc.partner_id.branch">
                               -
                           </span>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-3">
                           <span><strong>โทร: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.phone">
                               <span t-field="doc.partner_id.phone"/>
                           </span>
                           <span t-if="not doc.partner_id.phone">
                               -
                           </span>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-3">
                           <span><strong>ผู้ติดต่อ: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.contact_person">
                               <span t-field="doc.contact_person"/>
                           </span>
                           <span t-if="not doc.contact_person">
                               -
                           </span>
                       </div>
                   </div>
                </div>
                <div class="col-5">
                    <div class="row">
                       <div class="col-5">
                           <span><strong>พนักงานขาย: </strong></span>
                       </div>
                       <div class="col-7">
                           <span t-if="doc.invoice_user_id.name">
                               <span t-field="doc.invoice_user_id.name"/>
                           </span>
                           <span t-if="not doc.invoice_user_id.name">
                               -
                           </span>
                       </div>
                   </div>
                    <div class="row">
                       <div class="col-5">
                           <span><strong>เบอร์ติดต่อกลับ:</strong></span>
                       </div>
                       <div class="col-7">
                           <span t-if="doc.invoice_user_id.mobile">
                               <span t-field="doc.invoice_user_id.mobile"/>
                           </span>
                           <span t-if="not doc.invoice_user_id.mobile">
                               -
                           </span>
                       </div>
                   </div>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
            <div class="row" style="border-top: 1px solid black">
                <div style="padding: 5px;height: 500px">
                    <t t-set="l_no" t-value="0"/>
                    <table class="table" style="font-size: 14px;line-height: 18px">
                        <thead style="background-color:#ECECEC">
                            <tr>
                                <th class="text-center" style="width: 6%;">ลำดับ</th>
                                <th class="text-center" style="width: 40%;">รหัสสินค้า/รายละเอียดสินค้า</th>
                                <th class="text-center" style="width: 6%;">จำนวน</th>
                                <th class="text-center" style="width: 6%;">หน่วย</th>
                                <th class="text-center" style="width: 11%;">ราคา/หน่วย</th>
                                <th class="text-center" style="width: 6%;">ส่วนลด</th>
                                <th class="text-center" style="width: 6%;">VAT</th>
                                <th class="text-center" style="width: 19%;">มูลค่าก่อนภาษี</th>
                            </tr>
                        </thead>
                        <tbody style="font-size: 12px">
                            <t t-set="set_no_vat" t-value="0"/>
                            <t t-set="set_vat" t-value="0"/>
                            <t t-set="set_dis" t-value="0"/>
                            <tr t-foreach="o.invoice_line_ids" t-as="ol">
                            <td class="text-center">
                                <t t-if="not ol.is_component">
                                    <t t-set="l_no" t-value="l_no + 1"/>
                                    <t t-esc="l_no"/>
                                </t>
                            </td>
                            <td class="text-left">
                                <span t-if="ol.name">
                                    <span t-field="ol.name"/>
                                </span>
                                <span t-if="not ol.name">
                                    -
                                </span>
                            </td>
                                <td class="text-center" >
                                <span t-if="ol.quantity">
                                    <span t-field="ol.quantity"/>
                                </span>
                                <span t-if="not ol.quantity">
                                    -
                                </span>
                            </td>
                            <td class="text-center" >
                                <span t-if="ol.product_uom_id">
                                    <span t-field="ol.product_uom_id"/>
                                </span>
                                <span t-if="not ol.product_uom_id">
                                    -
                                </span>
                            </td>
                            <td class="text-center" >
                                <span t-if="ol.price_unit">
                                    <span t-field="ol.price_unit"/>
                                </span>
                                <span t-if="not ol.price_unit">
                                    -
                                </span>
                            </td>
                            <td class="text-center">
                                <span t-if="ol.discount">
                                     <t t-set="discount" t-value="'{0:,.2f}'.format(float((ol.discount / 100) * (ol.quantity * ol.price_unit)))"/>
                                     <span t-esc="discount"/>
                                </span>
                                <span t-if="not ol.discount">
                                    -
                                </span>
                            </td>
                            <td>
                                <div class="row">
                                    <div class="col-12 text-right">
                                        <span t-if="ol.tax_ids">
                                            <span t-esc="'{0:,.0f}'.format(float(ol.tax_ids.amount))"/>%
                                            <t t-if="ol.product_id.bill_discount == False">
                                                <t t-if="ol.tax_ids.amount == 0">
                                                    <t t-set="set_no_vat" t-value="set_no_vat + ol.price_subtotal"/>
                                                </t>
                                                <t t-if="ol.tax_ids.amount == 7">
                                                    <t t-set="set_vat" t-value="set_vat + ol.price_subtotal"/>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <t t-set="set_dis" t-value="set_dis + ol.price_subtotal"/>
                                            </t>
                                        </span>
                                        <span t-if="not ol.tax_ids">
                                            <t t-if="ol.product_id.bill_discount == False">
                                               <t t-set="set_no_vat" t-value="set_no_vat + ol.price_subtotal"/>
                                            </t>
                                            <t t-else="">
                                               <t t-set="set_dis" t-value="set_dis + ol.price_subtotal"/>
                                            </t>
                                            -
                                        </span>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="row">
                                    <div class="col-12 text-right">
                                        <span t-if="ol.price_subtotal">
                                            <span t-field="ol.price_subtotal"/>
                                        </span>
                                        <span t-if="not ol.price_subtotal">
                                            -
                                        </span>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="footer" style="margin-top:0mm;vertical-align: bottom;font-family: Kanit">
            <div class="last-page not-first-page" style="font-size: 15px">
                <div class="row">
                    <br/>
                    <div class="col-7">
                        <div class="col-12">
                            <div class="row" style="background-color:#ECECEC">
                                <div class="col-4 text-left"><strong>ยอดรวมสุทธิ:</strong></div>
                                <div class="col-8 text-left"><span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_total), o.currency_id.currency_unit_label)"/></div>
                            </div>
                            <div class="row">
                                <div class="col-4 text-left">หมายเหตุ: </div>
                                <div class="col-8 text-left"><span t-field="doc.narration"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-5" style="background-color:#ECECEC">
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่าส่วนลดรวม</strong></div>
                            <div class="col-4 text-right">
                                <span t-esc="'{0:,.2f}'.format(float(abs(set_dis)))"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่ารวมก่อนหักภาษี 0%</strong></div>
                            <div class="col-4 text-right"><span t-esc="'{0:,.2f}'.format(float(set_no_vat))"/></div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่ารวมก่อนหักภาษี 7%</strong></div>
                            <div class="col-4 text-right"><span t-esc="'{0:,.2f}'.format(float(set_vat))"/></div>
                        </div>
                        <div class="row" >
                            <div class="col-8 text-left"><strong>ภาษีมูลค่าเพิ่ม 7%</strong></div>
                            <div class="col-4 text-right" style="border-bottom: 1px solid black"><span t-esc="'{0:,.2f}'.format(float(doc.amount_tax))"/></div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>จำนวนเงินสุทธิ</strong></div>
                            <div class="col-4 text-right" style="border-bottom: 3px double black"><span t-esc="'{0:,.2f}'.format(float(doc.amount_total))"/></div>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <div class="row" style="font-size: 15px;border-top: 1px solid black">
                <div class="col-2 " align="center">
                    <div class="row" style="font-size: 13px;margin-top:1mm">สแกนเพื่อเปิดด้วยเว็บไซต์</div>
                    <div class="row" style="margin-top:0mm">
                    <t t-set="share_url"
                        t-value="doc._get_share_url(redirect=True, signup_partner=False)"
                    />
                    <t t-set="base_url"
                                t-value="doc.get_base_url()"
                    />
                    <t t-set="sum_url" t-value="base_url + share_url"/>
                    <img t-att-src="'data:image/png;base64,%s' % doc.generate_qr_code(sum_url)" style="height:100px; width:100px"/>
<!--                        <img t-att-src="'/report/barcode/QR/'+ 'aaa&#x3F;'" style="width:120px;height:90px" alt="Barcode"/>-->
                    </div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้ออกเอกสาร/ผู้ขาย</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้อนุมัติเอกสาร/ผู้ขาย</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้รับเอกสาร/ผู้ซื้อ</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ตราประทับ (ผู้ขาย)</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">&#160;</div>
                    <div>..........................................</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ตราประทับ (ผู้ซื้อ)</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">&#160;</div>
                    <div>..........................................</div>
                </div>
            </div>
            <div  class="row text-right" style="font-size: 15px;border-top: 1px solid black">
                <div class="col-12 text-right">
                    <span>Page </span>
                    <span class="page"/>
                    /
                    <span class="topage"/>
                </div>
            </div>
        </div>
    </template>


    <template id="MPF_invoice_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.MPF_invoice_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="ac_tax_inv_dep_rc_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.ac_tax_inv_dep_rc_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="ac_tax_inv_dep_rc_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;">
                        <span t-field="doc.billing_route_id.name"/>
                    </p>
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <p style="padding: 0px; margin-right: 50px;">
                        <t t-esc="doc.billing_route_id.name"/>
                    </p>
                    <!-- <span t-field="doc.form_no"/>[ตัด] -->
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 10.67px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="row">
                    <div class="col-4"></div>
                    <div class="col-8 text-left">
                        <span style="font-size: 28px;">
                            <strong>
                                รับเงินมัดจำ
                            </strong>         
                        </span>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>                                                    
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                     <t t-esc="doc.name"/>
                </div>
                <br />
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>

    <template id="ac_tax_inv_dep_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.ac_tax_inv_dep_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="ac_tax_inv_dep_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;">
                        <span t-field="doc.billing_route_id.name"/>
                    </p>
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <p style="padding: 0px; margin-right: 50px;">
                        <t t-esc="doc.billing_route_id.name"/>
                    </p>
                    <!-- <span t-field="doc.form_no"/>[ตัด] -->
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 16px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="row">
                    <div class="col-4"></div>
                    <div class="col-8 text-left">
                        <span style="font-size: 42px">
                            <strong>
                                เบิกสินค้าจากใบรับเงินมัดจำ
                            </strong>
                        </span>
                    </div>
                    <div class="col-6">                
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>                                                    
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                     <t t-esc="doc.name"/>
                </div>
                <br />
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>

    <template id="mpf_tax_inv_pp_report">
        <t t-call="web.html_container">
            <t t-if="error_message">
                <div style="color:red; font-size:16px; padding:20px;">
                    <strong>ผิดพลาด:</strong> <t t-esc="error_message"/>
                </div>
            </t>
            <t t-if="not error_message">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hdc_account_general_reports.MPF_tax_invoice_preprint_report_document" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </t>
    </template>

    <template id="MPF_tax_invoice_preprint_report_document">
    <t t-if="not o and doc">
        <t t-set="o" t-value="doc" />
    </t>
    <t t-if="o and 'company_id' in o">
        <t t-set="company" t-value="o.company_id.sudo()" />
    </t>
    <t t-if="not o or not 'company_id' in o">
        <t t-set="company" t-value="res_company" />
    </t>
    <t t-set="sale_order"
        t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])" />

    <div class="header" style="font-family: AngsanaUPC;margin-top: -15px;">
        <div>
            <div class="d-flex" style="margin-left: 5%;font-size:17.5pt;">
                <div
                    style="margin-top: 60px;margin-left: -15px; width: 70%;position: relative; top: 130px;">
                    <!-- 1xxxxxxxxxxxxxxxx -->
                    <t t-if="sale_order and sale_order.name">
                        <span t-field="sale_order.name" />
                    </t>
                    <t t-if="not sale_order">
                        <span t-field="doc.invoice_origin" />
                    </t>
                </div>
                <div class="d-flex" style="margin-top: 50px;">
                </div>
            </div>

            <div class="d-flex"
                style="margin-left: 5%; position: relative; top: 100px;position: relative; left: 105px;font-size:16px;">
                <div style="margin-top: 30px;margin-left: 15px; width: 70%;font-size:15pt;">
                    <!-- 2xxxxxxxxxxxxxxxxxxxxxxx -->
                    <t t-if="doc.partner_id.ref or doc.partner_id.cus_doc_id.name">
                        <span t-if="doc.partner_id.ref" t-field="doc.partner_id.ref" />
                        <span t-if="doc.partner_id.cus_doc_id.name"
                            t-field="doc.partner_id.cus_doc_id.name" />
                        <br />
                    </t>
                    <t t-if="not doc.partner_id.ref and not doc.partner_id.cus_doc_id.name">
                        <br />
                    </t>
                </div>
            </div>

            <div class="d-flex"
                style="margin-left: 70%;position: relative; top: 15px;font-size:20pt;">
                <p style="padding: 0px; margin-right: 50px; position: relative; left: -35px;">
                    <t t-if="doc.billing_route_id">
                        <span t-field="doc.billing_route_id.name" />
                    </t>
                    <t t-if="not doc.billing_route_id">
                        <br />
                    </t>
                </p>

                <!-- form_no ตำแหน่งเดิม -->
                <t t-if="doc.form_no">
                    <span t-field="doc.form_no" />
                </t>
                <t t-if="not doc.form_no">
                    <br />
                </t>
            </div>


            <div class="d-flex"
                style="margin-left: 68%;position: relative; top: 7px;font-size:20pt;">
                <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                <p style="padding: 0px; margin-right: 50px;position: relative; left: -25px;">
                    <!-- 3xxxxxxxxxxxxxx -->
                    <t t-if="doc.billing_terms_id.code">
                        <span t-field="doc.billing_terms_id.code" />
                    </t>
                    <t t-if="not doc.billing_terms_id.code">
                        <!-- <span style="color: white">-</span> -->
                        <br />
                    </t>
                </p>
            </div>

            <div class="d-flex"
                style="margin-left: 10%; position: relative;top:40px; font-size: 17.5pt;">
                <div class="text-nowrap" style="margin-right: 10px; ">
                    <!-- 4xxxxxxxxxxxxxxxxxxxxxx -->
                    <t t-if="doc.partner_id.name">
                        <span t-field="doc.partner_id.name" />
                    </t>
                    <t t-if="not doc.partner_id.name">
                        <span style="color: white">-</span>
                    </t>
                </div>
                <div style="margin-right: 45%;">
                    <t t-if="doc.partner_id">
                        <t t-if="doc.partner_id.is_head_office">
                            <span t-esc="doc.partner_id.branch_name" />
                        </t>
                        <t t-else="">
                            <span>
                                <t t-esc="doc.partner_id.branch_name" /> สาขาที่ <t
                                    t-esc="doc.partner_id.branch" />
                            </span>
                        </t>
                    </t>
                    <t t-else="">
                        <span style="color: white">-</span>
                    </t>
                </div>
            </div>

            <div class="d-flex">
                <div class="d-flex"
                    style="margin-right: 30%;width: 400px;position: relative;top:35px; font-size: 17.5pt;">
                    <!-- 5xxxxxxxxxxxxxxxxxxxxxx
                        5.1xxxxxxxxxxxxxxxxxxxxxx -->
                    <span t-field="doc.partner_id.street" />
                    <span t-field="doc.partner_id.street2" />
                    <span t-field="doc.partner_id.sub_district" />
                    <span t-field="doc.partner_id.city" />
                    <span t-field="doc.partner_id.state_id" />
                    <span t-field="doc.partner_id.zip" />

                </div>
                <div style="padding: 0px; margin: 0px;top: -5px;position: relative; font-size: 17.5pt;">
                    <!-- 6xxxxxxxxxxxxxxxxxxxxxx -->
                    <t t-if="doc.invoice_date">
                        <span t-field="doc.invoice_date" />
                    </t>
                    <t t-if="not doc.invoice_date">
                        <span style="color: white">-</span>
                    </t>
                </div>
            </div>

            <div class="d-flex">
                <div class="d-flex" style="margin-right: 30%; width: 400px;">

                    <t t-if="doc.sale_spec_employee">
                        <span style="position: relative; left: 600px;font-size: 17.5pt;">Spec</span>
                    </t>

                </div>
                <div style="padding: 0px; margin: 0px;width: 200px; position: relative; top: -20px;font-size: 17.5pt;">

                    <t t-if="doc.sale_spec_employee">
                        <span t-field="doc.sale_spec_employee.name" />/<span
                            t-field="doc.sale_spec_employee.phone" />
                    </t>
                    <t t-if="not doc.sale_spec_employee">
                        <span style="color: white">-</span>
                    </t>
                </div>
            </div>

            <div class="d-flex">
                <div class="d-flex" style="margin-right: 32%; width: 400px;">
                    <!-- 5.6xxxxxxxxxxxxxxxxxxxxxx
                        5.7xxxxxxxxxxxxxxxxxxxxxx -->
                </div>
                <div class="text-nowrap"
                    style="padding: 0px; margin: 0px;width: 200px; position: relative; top: -50px;font-size: 17.5pt;">
                    <t t-if="doc.invoice_user_employee_id">
                        <span t-field="doc.invoice_user_employee_id.name" />/<span
                            t-field="doc.invoice_user_employee_id.phone" />
                    </t>
                    <t t-if="not doc.invoice_user_employee_id">
                        <span style="color: white">-</span>
                    </t>
                </div>
            </div>

            <div class="d-flex">
                <div class="d-flex" style="margin-right: 30%; width: 400px;">
                </div>
                <div
                    style="padding: 0px; margin: 0px;top: -40px;text-align: center;width: 200px;position: relative; position: relative; left: 40px;font-size:17.5pt;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat" />
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                </div>
            </div>

            <div class="d-flex">
                <div class="d-flex"
                    style="margin-right: 30%; width: 400px;position: relative; top: -50px;font-size:17.5pt;">
                    <!-- 10xxxxxxxxxxxxxxxxxxxxxx -->
                    <t t-if="doc.partner_id.phone">โทร: <span t-field="doc.partner_id.phone" /></t>
                    <t t-if="doc.partner_id.fax">โทรสาร: <span t-field="doc.partner_id.fax" /></t>

                </div>
                <div
                    style="padding: 0px; margin: 0px;margin-left: -18px;text-align: center;width: 200px;position: relative; top: -40px;position: relative; left: 40px;font-size:17.5pt;">
                    <!-- 11xxxxxxxxxxxxxxxxxxxxxx -->
                    <t t-if="doc.invoice_payment_term_id">
                        <span t-field="doc.invoice_payment_term_id.name" />
                    </t>
                    <t t-if="not doc.invoice_payment_term_id">
                        <span style="color: white">-</span>
                    </t>
                </div>
            </div>

        </div>
        <div>
            <div class="row" style="height: 33px">
                <span style="color: white">-</span>
            </div>
        </div>
    </div>

    <div class="article" style="font-family: AngsanaUPC; border: 2px solid white;">
        <style>
            thead th {
            height: 57px;
            }
        </style>
        <!--<div
        style="margin-top: 100px;">-->
        <div class="row">
            <t t-set="l_no" t-value="0" />
            <table class="table table-borderless" style="line-height: 14px;">
                <thead style="height: 30px">
                    <tr>
                        <th class="text-center" style="width: 3%;color: white">1</th>
                        <th class="text-center" style="width: 50%;color: white">2</th>
                        <th class="text-center" style="width: 5%;color: white">3</th>
                        <th class="text-center" style="width: 10%;color: white">4</th>
                        <th class="text-center" style="width: 4%;color: white">5</th>
                        <th class="text-center" style="width: 12%;color: white">6</th>
                        <th class="text-center" style="width: 16%;color: white">7</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="doc.invoice_line_ids.sorted(key=lambda l: l.sequence)" t-as="ol">
                        <!-- กรณีบรรทัดประเภทหัวข้อ/หมายเหตุ -->
                        <t t-if="ol.display_type in ['line_section', 'line_note']">
                            <tr style="font-size: 17.5pt;">
                                <td />
                                <td colspan="6" class="text-left">
                                    <t t-if="ol.display_type == 'line_note'">
                                        <em>
                                            <span t-field="ol.name" />
                                        </em>
                                    </t>
                                    <t t-elif="ol.display_type == 'line_section'">
                                        <strong>
                                            <span t-field="ol.name" />
                                        </strong>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>
                            </tr>
                        </t>

                        <!-- กรณีบรรทัดสินค้าปกติ -->
                        <t t-else="">
                            <tr>
                                <td class="text-center" style="font-size: 17.5pt;">
                                    <t t-if="not ol.is_component">
                                        <t t-set="l_no" t-value="l_no + 1" />
                                        <t t-esc="l_no" />
                                    </t>
                                </td>

                                <!-- คอลัมน์ชื่อสินค้า ตาม form_label_type -->
                                <td class="text-left" style="font-size: 17.5pt;">
                                    <t t-if="doc.form_label_type == 'label'">
                                        <span t-if="ol.name">
                                            <span t-field="ol.name" />
                                        </span>
                                        <span t-if="not ol.name">-</span>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'name'">
                                        <span t-if="ol.product_id.name">
                                            <span t-field="ol.product_id.name" />
                                        </span>
                                        <span t-if="not ol.product_id.name">-</span>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'ref_name'">
                                        <span t-field="ol.internal_reference" />
                                        <span t-field="ol.name" />
                                    </t>
                                    <t t-elif="doc.form_label_type == 'barcode_name'">
                                        <span t-field="ol.barcode_modern_trade" />
                                        <span t-field="ol.name" />
                                    </t>
                                    <t t-elif="doc.form_label_type == 'external_code_name'">
                                        <span t-field="ol.external_item" />
                                        <span t-field="ol.description_customer" />
                                    </t>
                                </td>
                                <td class="text-left text-nowrap"
                                    style="position:relative; left: -9px;font-size: 17.5pt;">
                                    <span style="display:inline-block; width:47px; text-align:left;">
                                        <t t-esc="(ol.triple_discount or '').replace('+', ',')" />
                                    </span>
                                </td>
                                <td class="text-right"
                                    style="position:relative; left:-15px;font-size: 17.5pt;">
                                    <t t-if="ol.quantity">
                                        <t t-set="qty" t-value="float(ol.quantity)" />
                                        <t t-if="qty.is_integer()">
                                            <!-- เป็นจำนวนเต็ม เช่น 10.00 => แสดง 10 -->
                                            <span t-esc="'{:,.0f}'.format(qty)" />
                                        </t>
                                        <t t-else="">
                                            <!-- มีทศนิยม เช่น 10.30 => แสดง 10.30 -->
                                            <span t-esc="'{:,.2f}'.format(qty)" />
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>

                                <td class="text-right" style="font-size:15pt;">
                                    <span t-if="ol.product_uom_id.name">
                                        <span t-field="ol.product_uom_id.name" />
                                    </span>
                                    <span t-if="not ol.product_uom_id.name">-</span>
                                </td>
                                <td class="text-right" style="font-size: 17.5pt;">
                                    <!-- <span t-if="ol.price_unit"><span
                                    t-esc="'{:,.4f}'.format(float(ol.price_unit))"/></span>
                                        <span t-if="not ol.price_unit">-</span> -->
                                    <span t-esc="show_digits(ol.price_unit)" />
                                </td>
                                <td class="text-right" style="font-size: 17.5pt;">
                                    <!-- <span t-if="ol.price_subtotal"><span
                                    t-esc="'{:,.2f}'.format(float(ol.price_subtotal))"
                                    style="margin-right:3px;"/></span>
                                        <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span> -->
                                    <t t-if="ol.tax_ids and ol.tax_ids[0].price_include">
                                        <span t-if="ol.price_total">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_total))"
                                                style="margin-right:3px;" />
                                        </span>
                                        <span t-if="not ol.price_total" style="margin-right:3px;">-</span>
                                    </t>
                                    <t t-else="">
                                        <span t-if="ol.price_subtotal">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))"
                                                style="margin-right:3px;" />
                                        </span>
                                        <span t-if="not ol.price_subtotal" style="margin-right:3px;">
                                            -</span>
                                    </t>
                                </td>
                            </tr>
                        </t>
                    </t>
                </tbody>
            </table>
        </div>
    </div>

    <div class="footer last-page" style="font-family: AngsanaUPC;">
        <div>
            <!--<div
            class="d-flex">-->
            <!--  <span style="color: white">1</span>-->
            <!--</div>-->

            <div style="position: absolute; top: 1px; left: 420px;font-size: 30.67px;">
                <!-- 16xxxxxxxxxxxxxxx -->
                <t t-if="doc.document_stamp_state_id">
                    <span t-field="doc.document_stamp_state_id.name" />
                </t>
                <t t-if="not doc.document_stamp_state_id">
                    <span style="color: white">-</span>
                </t>
            </div>

            <div class="row"
                style="justify-content: space-between; align-items: flex-start;position: relative; top: 25px;">
                <!-- ซ้าย -->
                <div style="margin-left: 20px; width: 50%;font-size: 17.5pt;">
                    <!-- สายส่ง: <span t-field="doc.transport_desc"/>  <span
                    t-field="doc.company_round_desc"/> --> สายส่ง: <span
                        t-field="doc.transport_line_id.name" />  <span
                        t-field="doc.company_round_id.name" />
                </div>

                <!-- ขวา -->
                <t t-if="doc.global_discount">
                    <div style="width: 46%;">
                        <table style="width: 100%; text-align: right;margin-right: 10px;font-size: 20pt;">
                            <tr>
                                <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                    รวมก่อนหักส่วนลด
                                </td>
                                <td style="width: 100px;font-size: 20pt">
                                    <span
                                        t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))" />
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                    ส่วนลด
                                </td>
                                <td style="width: 100px;font-size: 20pt">
                                    <span
                                        t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>
                <t t-else="">
                    <div style="width: 46%;color: white">
                        <table style="width: 100%; text-align: right;margin-right: 10px;font-size: 20pt">
                            <tr>
                                <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                    รวมก่อนหักส่วนลด
                                </td>
                                <td style="width: 100px;">
                                    <span
                                        t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))" />
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                    ส่วนลด
                                </td>
                                <td style="width: 100px;">
                                    <span
                                        t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>

            </div>


            <div class="row" style="margin-bottom: 2mm;">
                <div class="col-6" style="margin-top: 40px;">
                    <!--margin-top:
                    30px;-->

                    <div class="row"
                        style="margin-bottom: 2mm; margin-left: 20px;position: relative; top: -50px;font-size:17.5pt;">
                        <!-- PO -->
                        <t t-if="doc.customer_po">
                            <span t-field="doc.customer_po" />
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>

                        <!-- Project Name -->
                        <t t-if="doc.project_name and doc.project_name.project_name">
                            <span t-field="doc.project_name.project_name" />
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>

                        <!-- Modify Type -->
                        <t t-if="doc.modify_type_txt">
                            <span t-field="doc.modify_type_txt" />
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>

                        <!-- Plan Home -->
                        <t t-if="doc.plan_home">
                            <span t-field="doc.plan_home" />
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>

                        <!-- Room -->
                        <t t-if="doc.room">
                            <span t-field="doc.room" />
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                    <div class="row" style="margin-bottom: 2mm; margin-left: 20px;position: relative; top: -50px;">
                        <table style="width: 100%; text-align: left;font-size: 17.5pt;">
                            <tr>
                                <td style="text-align: left;">
                                    <t t-if="doc.remark_report">
                                        <span t-field="doc.remark_report" />
                                    </t>
                                    <t t-else="">
                                        <br />
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="row" style="margin-bottom: 2mm; position: relative; top: 7px;">
                        <div style="margin-left: 90%;">
                            <!-- 25xxxxxxxxxxxxxxx -->
                            <t t-set="total_weight"
                                t-value="sum(ol.product_id.weight for ol in doc.invoice_line_ids if ol.product_id.weight)" />
                            <t t-if="total_weight">
                                <span t-esc="'{:,.4f}'.format(float(total_weight))"
                                    style="position: relative; top: 11px;" />
                            </t>
                            <t t-if="not total_weight">
                                <span style="color: white">-</span>
                            </t>
                        </div>
                    </div>
                    <div class="row" style="margin-bottom: 2mm; position: relative; top: -70px;">
                        <table style="width: 100%; text-align: center;">
                            <tr>
                                <td style="width: 70%; padding-right: 10px;font-size: 17.5pt">
                                    <t t-if="doc.invoice_payments_widget">
                                        <span
                                            t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_total), o.currency_id.currency_unit_label)"
                                            style="position: relative; top: 20px;" />
                                    </t>
                                    <t t-else="">
                                        <span
                                            t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)"
                                            style="position: relative; top: 20px;" />
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="col-6" style="margin-left: -10px;">
                    <div class="row" style="margin-bottom: 2mm;">
                        <table style="width: 94%; text-align: right;">
                            <tr>
                                <span style="width: 100px; text-align: left; color: white;">-</span>
                            </tr>
                        </table>
                    </div>
                    <div class="row" style="margin-bottom: 2mm;">
                        <table style="width: 94%; text-align: right;">
                            <tr>
                                <span style="width: 100px; text-align: left; color: white;">-</span>
                            </tr>
                        </table>
                    </div>
                    <div class="row" style="margin-bottom: 2mm; position: relative; top: -50px;">
                        <!-- 17xxxxxxxxxxxxxxxxxxxxxx -->
                        <table style="width: 98%; text-align: right;">
                            <tr>
                                <td style="text-align: right;font-size: 20pt">
                                    <span t-esc="'{:,.2f}'.format(float(doc.amount_untaxed))" />
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="row" style="margin-bottom: 2mm;">
                        <table style="width: 94%; text-align: right;">
                            <tr>
                                <!-- <td style="width: 46%;"></td> -->
                                <td style="text-align: right;font-size: 20pt;">
                                    <t t-set="amount_by_group" t-value="doc.amount_by_group" />
                                    <t
                                        t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                        <t t-if="amount_by_group[0][1]">
                                            <t t-set="value" t-value="amount_by_group[0][1]" />
                                        </t>
                                        <t t-if="not amount_by_group[0][1]">
                                            <span style="color: white">-</span>
                                        </t>
                                        <!-- <span t-esc="'{:,.4f}'.format(float(value))"/> -->
                                        <t t-if="value is not None">
                                            <span t-esc="'{:,.2f}'.format(float(value))"
                                                style="color: white" />
                                        </t>
                                        <t t-else="">
                                            <span style="color: white">-</span>
                                        </t>

                                    </t>
                                    <t t-else="">
                                        <span style="color: white">-</span>
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="row" style="margin-bottom: 2mm; position: relative; top: -100px;">

                        <div style="width: 70%; text-align: right;font-size:20pt;">
                            <t t-if="doc.invoice_line_ids">
                                <t t-if="doc.invoice_line_ids[0].tax_ids">
                                    <div style="margin-right: 8px; display: inline-block;">
                                        <span t-field="doc.invoice_line_ids[0].tax_ids.amount"
                                            t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}" />
                                        %
                                    </div>
                                </t>
                                <t t-else="">
                                    <span style="color: white">-</span>
                                </t>
                            </t>
                        </div>
                        <!-- ฝั่งซ้าย: amount_by_group -->
                        <div style="width: 30%;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <td style="width: 100px; text-align: right;font-size: 20pt">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group" />
                                        <t
                                            t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                                <t t-set="value" t-value="amount_by_group[0][1]" />
                                                <t t-if="value is not None">
                                                    <span t-esc="'{:,.2f}'.format(float(value))" />
                                                </t>
                                                <t t-else="">
                                                    <span>-</span>
                                                </t>
                                            </t>
                                            <t t-if="not amount_by_group[0][1]">
                                                <span>-</span>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>

                    <div class="row" style="margin-top: 5px; margin-bottom: 1mm;">
                        <table style="width: 94%; text-align: left;">
                            <tr>
                                <td style="width: 30%; text-align: right;color: white">
                                    <span style="color: white">-</span>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div class="row"
                        style="margin-top: 15px; margin-bottom: 2mm; position: relative; top: -140px;">
                        <table style="width: 98%; text-align: right;">
                            <tr>
                                <td style="width: 30%; text-align: right;font-size: 20pt">
                                    <t t-if="doc.invoice_payments_widget">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_total))" />
                                    </t>
                                    <t t-else="">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_residual))" />
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>

                </div>
            </div>

            <div class="row"
                style="margin-left: 70%; justify-content: flex-end; position: relative; top: -150px;">
                <table style="width: 94%; text-align: right;">
                    <tr>
                        <td style="padding: 0px; margin-right: 50px; text-align: right;">
                            <span style="color: white">-</span>
                        </td>
                        <td style="width: 250px;font-size:17.5pt;">
                            <t t-if="doc.billing_period_id"> BL: <span
                                    t-field="doc.billing_period_id.name" />
                            </t>
                            <t t-if="not doc.billing_period_id">
                                <span style="color: white">-</span>
                            </t>

                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 0px; margin-right: 50px; text-align: right;">
                            <span style="color: white">-</span>
                        </td>
                        <td style="width: 250px;font-size: 17.5pt;">
                            <t t-if="doc.billing_place_id"> RE: <span
                                    t-field="doc.billing_place_id.name" />
                            </t>
                            <t t-if="not doc.billing_place_id">
                                <span style="color: white">-</span>
                            </t>

                        </td>
                    </tr>
                </table>
            </div>


            <div style="position: absolute; top: 210px; left: 420px;font-size: 17.5pt;">
                <span t-field="doc.name" />
            </div>

            <!-- อยู่กับที่กลางหน้ากระดาษ -->
            <div
                style="position: absolute; top: 280px; left: 30%; width: 400px;text-align: center;font-size: 18.67pt;">
                <span t-field="doc.user_sale_agreement_employee.name" />
                <br />
                <!--<span
                t-field="doc.user_sale_agreement_employee.work_phone"/><br/>-->
                <span t-field="doc.user_sale_agreement_employee.work_email" />
            </div>

        </div>
    </div>
</template>

    <template id="MPF_invoice_preprint_weight_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.MPF_invoice_preprint_weight_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="MPF_invoice_preprint_weight_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;">
                        <span t-field="doc.billing_route_id.name"/>
                    </p>
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <p style="padding: 0px; margin-right: 50px;">
                        <t t-esc="doc.billing_route_id.name"/>
                    </p>
                    <!-- <span t-field="doc.form_no"/>[ตัด] -->
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 10.67px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div style="position: absolute; right: 600px;">
                    <t t-set="total_weight" t-value="0" />
                    <t t-foreach="doc.invoice_line_ids" t-as="line">
                        <t t-set="total_weight" t-value="total_weight + line.product_id.weight"/>
                    </t>
                    <span>
                        <t t-esc="total_weight" style="margin-right: 10px;" />g.
                    </span>
                </div>
                <br />
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                     <t t-esc="doc.name"/>
                </div>
                <br />
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>



    <template id="MPF_invoice_report_document_copy">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>

        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit" >
            <div class="row">
                <div class="col-7 text-left">
                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo.decode('ascii')" class="pull-left" style="max-height: 140px; max-width: 140px;"/>
                </div>
                <div class="col-5 text-right"  style="margin-right:0mm;margin-top:3mm">
                    <div style="font-size: 15px" >
                        <span>เอกสารออกเป็นชุด</span>
                    </div>
                    <div style="font-size: 25px" >
                        <span><strong>ใบแจ้งหนี้ (Invoice)</strong></span>
                    </div>
                    <div style="font-size: 15px" >
                        <span>สำเนา/Copy</span>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top:3mm">
                <div class="col-7">
                    <div class="row">
                        <div class="col-12">
                            <span t-field="company.name"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span t-field="company.street"/>
                            <span t-field="company.street2"/>
                            <span t-field="company.sub_district"/>
                            <span t-field="company.city"/>
                            <span t-field="company.state_id.name"/>
                            <span t-field="company.zip"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            เลขประจำตัวผู้เสียภาษี: <span t-field="company.vat"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            โทร: <span t-field="company.phone"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            E-mail:
                            <t t-if="company.email">
                                    <span t-field="company.email"/>
                            </t>
                            <t t-else="">
                                    -
                            </t>

                            <t t-if="company.website">
                                    / <span t-field="company.website"/>
                            </t>
                            <t t-else="">
                                    -
                            </t>
                        </div>
                    </div>
                </div>
                <div class="col-5" style="background-color:#ECECEC">
                    <div class="row">
                        <div class="col-5">
                            <span><strong>เลขที่เอกสาร: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.name">
                               <span t-field="doc.name"/>
                           </span>
                           <span t-if="not doc.name">
                               -
                           </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>วันที่เอกสาร: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.invoice_date">
                               <span t-field="doc.invoice_date"/>
                            </span>
                            <span t-if="not doc.invoice_date">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>เงื่อนไขการชำระ: </strong></span>
                        </div>
                        <div class="col-7">
                            <span t-if="doc.invoice_payment_term_id.name">
                               <span t-field="doc.invoice_payment_term_id.name"/>
                            </span>
                            <span t-if="not doc.invoice_payment_term_id.name">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>กำหนดชำระ: </strong></span>
                        </div>
                        <div class="col-7">
                             <span t-if="doc.invoice_date_due">
                               <span t-field="doc.invoice_date_due"/>
                            </span>
                            <span t-if="not doc.invoice_date_due">
                               -
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-5">
                            <span><strong>อ้างอิง: </strong></span>
                        </div>
                        <div class="col-7">
                             <span t-if="doc.payment_reference">
                               <span t-field="doc.payment_reference"/>
                            </span>
                            <span t-if="not doc.payment_reference">
                               -
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top:3mm;border-top: 1px solid black">
                <div class="col-7">
                    <div class="row">
                           <div class="col-3">
                               <span><strong>ลูกค้า: </strong></span>
                           </div>
                           <div class="col-9">
                               <span t-if="doc.partner_id.name">
                                   <span t-field="doc.partner_id.name"/>
                               </span>
                               <span t-if="not doc.partner_id.name">
                                   -
                               </span>
                           </div>
                       </div>
                    <div class="row">
                       <div class="col-3">
                           <span><strong>ที่อยู่: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.street">
                               <span t-field="doc.partner_id.street"/>
                           </span>
                           <span t-if="doc.partner_id.street2">
                               <span t-field="doc.partner_id.street2"/>
                           </span>
                           <span t-if="doc.partner_id.sub_district">
                               <span t-field="doc.partner_id.sub_district"/>
                           </span>
                           <span t-if="doc.partner_id.city">
                               <span t-field="doc.partner_id.city"/>
                           </span>
                           <span t-if="doc.partner_id.state_id.name">
                               <span t-field="doc.partner_id.state_id.name"/>
                           </span>
                           <span t-if="doc.partner_id.zip">
                               <span t-field="doc.partner_id.zip"/>
                           </span>
                       </div>
                   </div>
                     <div class="row">
                       <div class="col-3">
                           <span><strong>เลขที่ภาษี: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.vat">
                               <span t-field="doc.partner_id.vat"/>
                           </span>
                           <span t-if="not doc.partner_id.vat">
                               -
                           </span>
                       </div>
                   </div>
                    <div class="row">
                       <div class="col-3">
                           <span><strong>สาขา: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.branch">
                               <span t-field="doc.partner_id.branch"/>
                           </span>
                           <span t-if="not doc.partner_id.branch">
                               -
                           </span>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-3">
                           <span><strong>โทร: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.partner_id.phone">
                               <span t-field="doc.partner_id.phone"/>
                           </span>
                           <span t-if="not doc.partner_id.phone">
                               -
                           </span>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-3">
                           <span><strong>ผู้ติดต่อ: </strong></span>
                       </div>
                       <div class="col-9">
                           <span t-if="doc.contact_person">
                               <span t-field="doc.contact_person"/>
                           </span>
                           <span t-if="not doc.contact_person">
                               -
                           </span>
                       </div>
                   </div>
                </div>
                <div class="col-5">
                    <div class="row">
                       <div class="col-5">
                           <span><strong>พนักงานขาย: </strong></span>
                       </div>
                       <div class="col-7">
                           <span t-if="doc.invoice_user_id.name">
                               <span t-field="doc.invoice_user_id.name"/>
                           </span>
                           <span t-if="not doc.invoice_user_id.name">
                               -
                           </span>
                       </div>
                   </div>
                    <div class="row">
                       <div class="col-5">
                           <span><strong>เบอร์ติดต่อกลับ:</strong></span>
                       </div>
                       <div class="col-7">
                           <span t-if="doc.invoice_user_id.mobile">
                               <span t-field="doc.invoice_user_id.mobile"/>
                           </span>
                           <span t-if="not doc.invoice_user_id.mobile">
                               -
                           </span>
                       </div>
                   </div>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
            <div class="row" style="border-top: 1px solid black">
                <div style="padding: 5px;height: 500px">
                    <t t-set="l_no" t-value="0"/>
                    <table class="table" style="font-size: 14px;line-height: 18px">
                        <thead style="background-color:#ECECEC">
                            <tr>
                                <th class="text-center" style="width: 6%;">ลำดับ</th>
                                <th class="text-center" style="width: 40%;">รหัสสินค้า/รายละเอียดสินค้า</th>
                                <th class="text-center" style="width: 6%;">จำนวน</th>
                                <th class="text-center" style="width: 6%;">หน่วย</th>
                                <th class="text-center" style="width: 11%;">ราคา/หน่วย</th>
                                <th class="text-center" style="width: 6%;">ส่วนลด</th>
                                <th class="text-center" style="width: 6%;">VAT</th>
                                <th class="text-center" style="width: 19%;">มูลค่าก่อนภาษี</th>
                            </tr>
                        </thead>
                        <tbody style="font-size: 12px">
                            <t t-set="set_no_vat" t-value="0"/>
                            <t t-set="set_vat" t-value="0"/>
                            <t t-set="set_dis" t-value="0"/>
                            <tr t-foreach="o.invoice_line_ids" t-as="ol">
                            <td class="text-center">
                                <t t-if="not ol.is_component">
                                    <t t-set="l_no" t-value="l_no + 1"/>
                                    <t t-esc="l_no"/>
                                </t>
                            </td>
                            <td class="text-left">
                                <span t-if="ol.name">
                                    <span t-field="ol.name"/>
                                </span>
                                <span t-if="not ol.name">
                                    -
                                </span>
                            </td>
                                <td class="text-center" >
                                <span t-if="ol.quantity">
                                    <span t-field="ol.quantity"/>
                                </span>
                                <span t-if="not ol.quantity">
                                    -
                                </span>
                            </td>
                            <td class="text-center" >
                                <span t-if="ol.product_uom_id">
                                    <span t-field="ol.product_uom_id"/>
                                </span>
                                <span t-if="not ol.product_uom_id">
                                    -
                                </span>
                            </td>
                            <td class="text-center" >
                                <span t-if="ol.price_unit">
                                    <span t-field="ol.price_unit"/>
                                </span>
                                <span t-if="not ol.price_unit">
                                    -
                                </span>
                            </td>
                            <td class="text-center">
                                <span t-if="ol.discount">
                                     <t t-set="discount" t-value="'{0:,.2f}'.format(float((ol.discount / 100) * (ol.quantity * ol.price_unit)))"/>
                                     <span t-esc="discount"/>
                                </span>
                                <span t-if="not ol.discount">
                                    -
                                </span>
                            </td>
                            <td>
                                <div class="row">
                                    <div class="col-12 text-right">
                                        <span t-if="ol.tax_ids">
                                            <span t-esc="'{0:,.0f}'.format(float(ol.tax_ids.amount))"/>%
                                            <t t-if="ol.product_id.bill_discount == False">
                                                <t t-if="ol.tax_ids.amount == 0">
                                                    <t t-set="set_no_vat" t-value="set_no_vat + ol.price_subtotal"/>
                                                </t>
                                                <t t-if="ol.tax_ids.amount == 7">
                                                    <t t-set="set_vat" t-value="set_vat + ol.price_subtotal"/>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <t t-set="set_dis" t-value="set_dis + ol.price_subtotal"/>
                                            </t>
                                        </span>
                                        <span t-if="not ol.tax_ids">
                                            <t t-if="ol.product_id.bill_discount == False">
                                               <t t-set="set_no_vat" t-value="set_no_vat + ol.price_subtotal"/>
                                            </t>
                                            <t t-else="">
                                               <t t-set="set_dis" t-value="set_dis + ol.price_subtotal"/>
                                            </t>
                                            -
                                        </span>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="row">
                                    <div class="col-12 text-right">
                                        <span t-if="ol.price_subtotal">
                                            <span t-field="ol.price_subtotal"/>
                                        </span>
                                        <span t-if="not ol.price_subtotal">
                                            -
                                        </span>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="footer" style="margin-top:0mm;vertical-align: bottom;font-family: Kanit">
            <div class="last-page not-first-page" style="font-size: 15px">
                <div class="row">
                    <br/>
                    <div class="col-7">
                        <div class="col-12">
                            <div class="row" style="background-color:#ECECEC">
                                <div class="col-4 text-left"><strong>ยอดรวมสุทธิ:</strong></div>
                                <div class="col-8 text-left"><span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_total), o.currency_id.currency_unit_label)"/></div>
                            </div>
                            <div class="row">
                                <div class="col-4 text-left">หมายเหตุ: </div>
                                <div class="col-8 text-left"><span t-field="doc.narration"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-5" style="background-color:#ECECEC">
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่าส่วนลดรวม</strong></div>
                            <div class="col-4 text-right">
                                <span t-esc="'{0:,.2f}'.format(float(abs(set_dis)))"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่ารวมก่อนหักภาษี 0%</strong></div>
                            <div class="col-4 text-right"><span t-esc="'{0:,.2f}'.format(float(set_no_vat))"/></div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>มูลค่ารวมก่อนหักภาษี 7%</strong></div>
                            <div class="col-4 text-right"><span t-esc="'{0:,.2f}'.format(float(set_vat))"/></div>
                        </div>
                        <div class="row" >
                            <div class="col-8 text-left"><strong>ภาษีมูลค่าเพิ่ม 7%</strong></div>
                            <div class="col-4 text-right" style="border-bottom: 1px solid black"><span t-esc="'{0:,.2f}'.format(float(doc.amount_tax))"/></div>
                        </div>
                        <div class="row">
                            <div class="col-8 text-left"><strong>จำนวนเงินสุทธิ</strong></div>
                            <div class="col-4 text-right" style="border-bottom: 3px double black"><span t-esc="'{0:,.2f}'.format(float(doc.amount_total))"/></div>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <div class="row" style="font-size: 15px;border-top: 1px solid black">
                <div class="col-2 " align="center">
                    <div class="row" style="font-size: 13px;margin-top:1mm">สแกนเพื่อเปิดด้วยเว็บไซต์</div>
                    <div class="row" style="margin-top:0mm">
                    <t t-set="share_url"
                        t-value="doc._get_share_url(redirect=True, signup_partner=False)"
                    />
                    <t t-set="base_url"
                                t-value="doc.get_base_url()"
                    />
                    <t t-set="sum_url" t-value="base_url + share_url"/>
                    <img t-att-src="'data:image/png;base64,%s' % doc.generate_qr_code(sum_url)" style="height:100px; width:100px"/>
<!--                        <img t-att-src="'/report/barcode/QR/'+ 'aaa&#x3F;'" style="width:120px;height:90px" alt="Barcode"/>-->
                    </div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้ออกเอกสาร/ผู้ขาย</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้อนุมัติเอกสาร/ผู้ขาย</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ลงชื่อ</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">ผู้รับเอกสาร/ผู้ซื้อ</div>
                    <div>............../............../..............</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ตราประทับ (ผู้ขาย)</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">&#160;</div>
                    <div>..........................................</div>
                </div>
                <div class="col-2 " align="center">
                    <div>ตราประทับ (ผู้ซื้อ)</div>
                    <br/><br/><br/>
                    <div style="font-size: 13px">&#160;</div>
                    <div>..........................................</div>
                </div>
            </div>
            <div  class="row text-right" style="font-size: 15px;border-top: 1px solid black">
                <div class="col-12 text-right">
                    <span>Page </span>
                    <span class="page"/>
                    /
                    <span class="topage"/>
                </div>
            </div>
        </div>
    </template>

    <template id="MPF_invoice_report_copy">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.MPF_invoice_report_document_copy" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="MPF_invoice_report_all">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.MPF_invoice_report_document" t-lang="doc.partner_id.lang"/>
                <t t-call="hdc_account_general_reports.MPF_invoice_report_document_copy" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>


    <template id="preprint_project_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.MPF_tax_invoice_preprint_project_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="MPF_tax_invoice_preprint_project_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <span t-field="doc.billing_route_id.name"/>
                    <span t-field="doc.name"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 50px;">[4] - เว้นไว้ก่อน</p> -->
                    <!-- <p style="">[6] - Form No.</p> -->
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 10.67px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="row">
                    <div class="col-5"></div>
                    <div class="col-7 text-left">
                        <span style="font-size: 28px">
                            <strong>
                                <span t-field="doc.document_stamp_state_id.name"/>    
                            </strong>         
                        </span>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                <div class="d-flex">
                    <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>
                    <span t-if="sale_order">
                        <t t-if="sale_order.project_name.project_name">
                            <span t-field="sale_order.project_name.project_name" />
                        </t>                        
                    </span>
                    <span t-if="not sale_order">
                        
                    </span>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                </div>
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>

    <template id="ac_tax_inv_pj_dep_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.ac_tax_inv_pj_dep_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="ac_tax_inv_pj_dep_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <span t-field="doc.billing_route_id.name"/>
                    <span t-field="doc.name"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 50px;">[4] - เว้นไว้ก่อน</p> -->
                    <!-- <p style="">[6] - Form No.</p> -->
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 10.67px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="row">
                    <div class="col-4"></div>
                    <div class="col-8 text-left">
                        <span style="font-size: 28px">
                            <strong>
                                เบิกสินค้าจากใบรับเงินมัดจำ
                            </strong>         
                        </span>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                 <div class="d-flex">
                    <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>
                    <span t-if="sale_order">
                        <t t-if="sale_order.project_name.project_name">
                            <span t-field="sale_order.project_name.project_name" />
                        </t>                        
                    </span>
                    <span t-if="not sale_order">
                        
                    </span>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                </div>
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>

    <template id="ac_tax_inv_pj_de_re_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="hdc_account_general_reports.ac_tax_inv_pj_de_re_report_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <template id="ac_tax_inv_pj_de_re_report_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <div class="header" style="font-family: Kanit; font-size: 12px" >
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 100px; width: 70%;">
                        <span t-field="doc.ref"/>
                    </div>

                    <div class="d-flex" style="margin-top: 100px;">
                        <span>Page </span>
                        <span class="page"/>
                        /
                        <span class="topage"/>
                    </div>
                </div>
                <div style="margin-top: 5px; margin-left: 100px;">
                    <span t-field="doc.partner_id.ref"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <span t-field="doc.billing_route_id.name"/>
                    <span t-field="doc.name"/>
                </div>
                <div class="d-flex" style="margin-left: 70%">
                    <!-- <p style="padding: 0px; margin-right: 50px;">[4] - เว้นไว้ก่อน</p> -->
                    <!-- <p style="">[6] - Form No.</p> -->
                    <span t-field="doc.form_no"/>
                </div>
                <div class="d-flex" style="margin-left: 10%;">
                    <div style="margin-right: 10px; ">
                        <span t-field="doc.partner_id.name"/>
                    </div>
                    <div style="margin-right: 45%;">
                        <span t-field="doc.partner_id.branch_name"/>
                    </div>
                    <!-- <p>09/05/2024???</p> -->
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                    </div>    
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>     
                    <div style="padding: 0px; margin: 0px">
                        <span t-field="doc.invoice_user_id.name"/>
                    </div>
                </div>
                <div class="d-flex" style="margin-left: 80%;">
                    <t t-if="doc.partner_id.vat">
                        <span t-field="doc.partner_id.vat"/>
                    </t>
                    <t t-if="not doc.partner_id.vat">
                        -
                    </t>
                    
                </div>
                <div class="d-flex" style="">
                    <div style="margin-right: 10px;">
                        <span t-field="doc.partner_id.phone"/>
                    </div>
                    <div style="margin-right: 65%;">
                        <span t-field="doc.partner_id.fax"/>
                    </div>
                    <!-- <span t-field="doc.invoice_payment_term_id.name"/>[e] -->
                    <span t-field="doc.invoice_date_due"/>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <div style="margin-top: 140px;">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.67px;line-height: 18px;">
                    <tbody style="font-size: 10.67px">
                        <tr t-foreach="doc.invoice_line_ids" t-as="ol">
                        <td class="text-center">
                            <t t-if="not ol.is_component">
                                <t t-set="l_no" t-value="l_no + 1"/>
                                <t t-esc="l_no"/>
                            </t>
                        </td>
                        <td class="text-left">
                            <span t-if="ol.product_id.name">
                                <span t-field="ol.product_id.name"/>
                            </span>
                            <span t-if="not ol.product_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.triple_discount">
                                <span t-field="ol.triple_discount"/>
                            </span>
                            <span t-if="not ol.triple_discount">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.quantity">
                                <span t-field="ol.quantity"/>
                            </span>
                            <span t-if="not ol.quantity">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.product_uom_id.name">
                                <span t-field="ol.product_uom_id.name"/>
                            </span>
                            <span t-if="not ol.product_uom_id.name">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_unit">
                                <span t-field="ol.price_unit"/>
                            </span>
                            <span t-if="not ol.price_unit">
                                -
                            </span>
                        </td>
                        <td class="text-center">
                            <span t-if="ol.price_subtotal">
                                <span t-field="ol.price_subtotal"/>
                            </span>
                            <span t-if="not ol.price_subtotal">
                                -
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer" style="font-size: 10.67px">
            <div class="" style="">
                <div class="d-flex" style="">
                    <span t-field="doc.transport_line_id.name"/>
                </div>
                <div class="row">
                    <div class="col-4"></div>
                    <div class="col-8 text-left">
                        <span style="font-size: 28px">
                            <strong>
                                รับเงินมัดจำ    
                            </strong>         
                        </span>
                    </div>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content; margin-top:30px;">
                    <div style="width: 300px;">
                    <span t-field="doc.narration"/>
                    </div>
                    <!-- <p style="margin-left: 95px;">
                        ติดต่อคุณแขก 083-9066-197???
                    </p> -->
                    <div style="margin-left: 100px;">
                        <span t-field="doc.amount_untaxed"/>
                    </div>
                </div>
                 <div class="d-flex">
                    <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>
                    <span t-if="sale_order">
                        <t t-if="sale_order.project_name.project_name">
                            <span t-field="sale_order.project_name.project_name" />
                        </t>                        
                    </span>
                    <span t-if="not sale_order">
                        
                    </span>
                </div>
                <div class="d-flex justify-content-end" style="width: fit-content;">
                    <div style="padding: 10px; margin-right: 100px;">
                    <t t-if="doc.invoice_line_ids">
                        <t t-if="doc.invoice_line_ids[0].tax_ids">
                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount"/>
                        </t>
                    </t>
                    </div>
                    <div style="">
                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                        <t t-if="amount_by_group and len(amount_by_group) > 0 and len(amount_by_group[0]) > 1">
                            <t t-if="amount_by_group[0][1]">
                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                            </t>
                            <t t-if="not amount_by_group[0][1]">
                                -
                            </t>
                            <span t-esc="value"/>
                        </t>
                        <t t-else="">
                            -
                        </t>
                    </div>
                </div>         
                <div class="d-flex justify-content-end">
                    <div style="padding: 10px 30px 10px 30px; margin-right: 50%;">
                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_residual), o.currency_id.currency_unit_label)" />
                    </div>
                    <div>
                        <span t-field="doc.amount_residual"/>
                    </div>
                </div>      
                <div class="d-flex justify-content-end" style="">
                    <!-- <p style="width: 160px;">[28] - Billing Period</p> -->
                    <span t-field="doc.billing_period_id.name"/>
                </div>
                <div style="margin-left: 45%;">
                    <!-- <p>[27] - เว้นไว้ก่อน</p> -->
                </div>
                <div style="margin-left: 40%;">
                    <span t-field="doc.create_uid"/>
                </div>
            </div>
        </div>

    </template>



    <template id="mpf_tax_inv_pp_20line_report">
        <t t-call="web.html_container">
            <t t-if="error_message">
                <div style="color:red; font-size:16px; padding:20px;">
                    <strong>ผิดพลาด:</strong> <t t-esc="error_message"/>
                </div>
            </t>
            <t t-if="not error_message">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hdc_account_general_reports.MPF_tax_inv_pp_20line_document" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </t>
    </template>

    <template id="MPF_tax_inv_pp_20line_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
            </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
            </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
            </t>
        <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>
        <div class="header" style="font-family: Kanit; font-size: 14px;margin-top: -15px;">
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 50px;margin-left: -15px; width: 70%;position: relative; top: 35px;">
                        <!-- 1xxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order">
                            <t t-if="sale_order.name">
                                <span t-field="sale_order.name"/>
                            </t>
                            <t t-if="not sale_order.name">
                                <span t-field="doc.invoice_origin"/>
                            </t>
                        </t>
                        <t t-if="not sale_order">
                            <span t-field="doc.invoice_origin"/>
                        </t>
                    </div>
                    <div class="d-flex" style="margin-top: 50px;">
                        </div>
                </div>
                <div class="d-flex" style="margin-left: 5%; position: relative; top: 49px;position: relative; left: 105px;">
                    <div style="margin-top: 30px;margin-left: 15px; width: 70%;">
                        <!-- 2xxxxxxxxxxxxxxxxxxxxxxx -->
                        <span t-field="doc.partner_id.ref"/>
                        <span t-field="doc.partner_id.cus_doc_id.name"/>
                    </div>
                    <!--<div class="d-flex" style="margin-top: 30px;">-->
                    <!--    <span>Page </span>-->
                    <!--    <span class="page"/>-->
                    <!--    /-->
                    <!--    <span class="topage"/>-->
                    <!--</div>-->
                </div>
                <!--<div style="margin-top: 5px; margin-left: 100px;color: white">-->
                <!--    3xxxxxxxxxxxxxx-->
                <!--</div>-->
                <div class="d-flex" style="margin-left: 70%;position: relative; top: 15px;">
                    <p style="padding: 0px; margin-right: 50px; position: relative; left: -35px;">
                        <t t-if="doc.billing_route_id">
                            <span t-field="doc.billing_route_id.name"/>
                        </t>
                        <t t-if="not doc.billing_route_id">
                            <span style="color: white">-</span>
                        </t>
                    </p>
                    <!-- form_no ตำแหน่งเดิม -->
                    <t t-if="doc.form_no">
                        <span t-field="doc.form_no"/>
                    </t>
                    <t t-if="not doc.form_no">
                        <span style="color: white">-</span>
                    </t>
                </div>
                <div class="d-flex" style="margin-left: 68%;position: relative; top: 7px;">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;position: relative; left: -25px;">
                        <!-- 3xxxxxxxxxxxxxx -->
                        <t t-if="doc.billing_terms_id.code">
                            <span t-field="doc.billing_terms_id.code"/>
                        </t>
                        <t t-if="not doc.billing_terms_id.code">
                            <span style="color: white">-</span>
                        </t>
                    </p>
                </div>
                <div class="d-flex" style="margin-left: 10%; position: relative; top: 37px; font-size: 18.67px">
                    <div class="text-nowrap" style="margin-right: 10px; ">
                        <!-- 4xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.partner_id.name">
                            <span t-field="doc.partner_id.name"/>
                        </t>
                        <t t-if="not doc.partner_id.name">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                    <div style="margin-right: 45%;">
                        <t t-if="doc.partner_id">
                            <t t-if="doc.partner_id.is_head_office">
                                <span t-esc="doc.partner_id.branch_name"/>
                            </t>
                            <t t-else="">
                                <span>
                                    <t t-esc="doc.partner_id.branch_name"/> สาขาที่
                                    <t t-esc="doc.partner_id.branch"/>
                                </span>
                            </t>
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;position: relative; top: 57px; font-size: 18.67px">
                        <!-- 5xxxxxxxxxxxxxxxxxxxxxx
                            5.1xxxxxxxxxxxxxxxxxxxxxx -->
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                    </div>
                    <div style="padding: 0px; margin: 0px;position: relative; top: 13px;font-size:18.67px;">
                        <!-- 6xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_date">
                            <span t-field="doc.invoice_date"/>
                        </t>
                        <t t-if="not doc.invoice_date">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <!-- 5.2xxxxxxxxxxxxxxxxxxxxxx
                            5.3xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.sale_spec_employee">
                            <span style="position: relative; left: 600px;">Sale Spec</span>
                        </t>
                    </div>
                    <div style="padding: 0px; margin: 0px;width: 200px;position: relative; top: -6px;">
                        <!-- 7xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.sale_spec_employee">
                            <span t-field="doc.sale_spec_employee.name"/>
                        </t>
                        <t t-if="not doc.sale_spec_employee">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.4xxxxxxxxxxxxxxxxxxxxxx
                            5.5xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_user_employee_id">
                            <span style="position: relative; left: 600px;">Sale Person</span>
                        </t>
                    </div>
                    <div style="padding: 0px; margin: 0px;width: 200px; position: relative; top: -1px;">
                        <!-- 8xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_user_employee_id">
                            <span t-field="doc.invoice_user_employee_id.name"/>/
                            <span t-field="doc.invoice_user_employee_id.phone"/>
                        </t>
                        <t t-if="not doc.invoice_user_employee_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.6xxxxxxxxxxxxxxxxxxxxxx
                            5.7xxxxxxxxxxxxxxxxxxxxxx -->
                    </div>
                    <div class="text-nowrap" style="padding: 0px; margin: 0px;width: 200px; position: relative; top: 1px;">
                        <!-- 9xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.team_id">
                            <span t-field="doc.team_id.name"/>
                        </t>
                        <t t-if="not doc.team_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        </div>
                    <div style="padding: 0px; margin: 0px;text-align: center;width: 200px;position: relative; top: 9px;position: relative; left: 40px;">
                        <t t-if="doc.partner_id.vat">
                            <span t-field="doc.partner_id.vat"/>
                        </t>
                        <t t-if="not doc.partner_id.vat">
                                -
                            </t>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;position: relative; top: -8px;">
                        <!-- 10xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.partner_id.phone">โทร:
                            <span t-field="doc.partner_id.phone"/>
                        </t>
                        <t t-if="doc.partner_id.fax">โทรสาร:
                            <span t-field="doc.partner_id.fax"/>
                        </t>
                    </div>
                    <div style="padding: 0px; margin: 0px;margin-left: -18px;text-align: center;width: 200px;position: relative; top: 15px;position: relative; left: 40px;">
                        <!-- 11xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_payment_term_id">
                            <span t-field="doc.invoice_payment_term_id.name"/>
                        </t>
                        <t t-if="not doc.invoice_payment_term_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
            </div>
            <div>
                <div class="row" style="height: 33px">
                    <span style="color: white">1</span>
                </div>
            </div>
        </div>
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
            <style>
                    thead th {
                    height: 57px;
                    }
                </style>
            <div class="row">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 10.8px; line-height: 17px; border-collapse: collapse;">
                    <thead style="height: 30px">
                        <tr>
                            <th class="text-center" style="width: 3%;color: white; padding-top:1px; padding-bottom:1px;">1</th>
                            <th class="text-center" style="width: 50%;color: white; padding-top:1px; padding-bottom:1px;">2</th>
                            <th class="text-center" style="width: 5%;color: white; padding-top:1px; padding-bottom:1px;">3</th>
                            <th class="text-center" style="width: 10%;color: white; padding-top:1px; padding-bottom:1px;">4</th>
                            <th class="text-center" style="width: 4%;color: white; padding-top:1px; padding-bottom:1px;">5</th>
                            <th class="text-center" style="width: 12%;color: white; padding-top:1px; padding-bottom:1px;">6</th>
                            <th class="text-center" style="width: 16%;color: white; padding-top:1px; padding-bottom:1px;">7</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="doc.invoice_line_ids.sorted(key=lambda l: l.sequence)" t-as="ol">
                            <t t-if="ol.display_type in ['line_section', 'line_note']">
                                <tr>
                                    <td/>
                                    <td colspan="6" class="text-left" style="padding-top:1px; padding-bottom:1px;">
                                        <t t-if="ol.display_type == 'line_note'">
                                            <em>
                                                <span t-field="ol.name"/>
                                            </em>
                                        </t>
                                        <t t-elif="ol.display_type == 'line_section'">
                                            <strong>
                                                <span t-field="ol.name"/>
                                            </strong>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                            <t t-else="">
                                <tr>
                                    <td class="text-center" style="padding-top:1px; padding-bottom:1px;">
                                        <t t-if="not ol.is_component">
                                            <t t-set="l_no" t-value="l_no + 1"/>
                                            <t t-esc="l_no"/>
                                            </t>
                                    </td>
                                    <td class="text-left" style="padding-top:1px; padding-bottom:1px;">
                                        <t t-if="doc.form_label_type == 'label'">
                                            <span t-if="ol.name">
                                                <span t-field="ol.name"/></span>
                                            <span t-if="not ol.name">-</span>
                                        </t>
                                        <t t-elif="doc.form_label_type == 'name'">
                                            <span t-if="ol.product_id.name">
                                                <span t-field="ol.product_id.name"/>
                                            </span>
                                            <span t-if="not ol.product_id.name">-</span>
                                        </t>
                                        <t t-elif="doc.form_label_type == 'ref_name'">
                                            <span t-field="ol.internal_reference"/>
                                            <span t-field="ol.name"/>
                                        </t>
                                        <t t-elif="doc.form_label_type == 'barcode_name'">
                                            <span t-field="ol.barcode_modern_trade"/>
                                            <span t-field="ol.name"/>
                                        </t>
                                        <t t-elif="doc.form_label_type == 'external_code_name'">
                                            <span t-field="ol.external_item"/>
                                            <span t-field="ol.description_customer"/>
                                        </t>
                                    </td>
                                    <td class="text-left text-nowrap" style="position:relative; left: -9px; padding-top:1px; padding-bottom:1px;">
                                        <span style="display:inline-block; width:47px; text-align:left;">
                                            <t t-esc="(ol.triple_discount or '').replace('+', ',')"/>
                                        </span>
                                    </td>
                                    <td class="text-right" style="position:relative; left:-7px; padding-top:1px; padding-bottom:1px;">
                                        <t t-if="ol.quantity">
                                            <t t-set="qty" t-value="float(ol.quantity)"/>
                                            <t t-if="qty.is_integer()">
                                                <span t-esc="'{:,.0f}'.format(qty)"/>
                                            </t>
                                            <t t-else="">
                                                <span t-esc="'{:,.2f}'.format(qty)"/>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>
                                    <td class="text-right" style="padding-top:1px; padding-bottom:1px;">
                                        <span t-if="ol.product_uom_id.name">
                                            <span t-field="ol.product_uom_id.name"/></span>
                                        <span t-if="not ol.product_uom_id.name">-</span>
                                    </td>
                                    <td class="text-right" style="padding-top:1px; padding-bottom:1px;">
                                        <span t-if="ol.price_unit">
                                            <span t-esc="'{:,.4f}'.format(float(ol.price_unit))"/></span>
                                        <span t-if="not ol.price_unit">-</span>
                                    </td>
                                    <td class="text-right" style="padding-top:1px; padding-bottom:1px;">
                                        <!-- <span t-if="ol.price_subtotal"><span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/></span>
                                            <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span> -->
                                        <t t-if="ol.tax_ids and ol.tax_ids[0].price_include">
                                            <span t-if="ol.price_total">
                                                <span t-esc="'{:,.2f}'.format(float(ol.price_total))" style="margin-right:3px;"/>
                                                </span>
                                            <span t-if="not ol.price_total" style="margin-right:3px;">-</span>
                                        </t>
                                        <t t-else="">
                                            <span t-if="ol.price_subtotal">
                                                <span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/>
                                                </span>
                                            <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="footer last-page" style="font-size: 12.67px;font-family: Kanit;">
            <div>
                <!--<div class="d-flex">-->
                <!--  <span style="color: white">1</span>-->
                <!--</div>-->
                <div style="position: absolute; top: 1px; left: 420px;font-size: 30.67px;">
                    <!-- 16xxxxxxxxxxxxxxx -->
                    <t t-if="doc.document_stamp_state_id">
                        <span t-field="doc.document_stamp_state_id.name"/>
                    </t>
                    <t t-if="not doc.document_stamp_state_id">
                        <span style="color: white">-</span>
                    </t>
                </div>
                <div class="row" style="justify-content: space-between; align-items: flex-start;position: relative; top: 36px;">
                    <!-- ซ้าย -->
                    <div style="margin-left: 20px; width: 50%;">
                            สายส่ง:
                        <span t-field="doc.company_round_id.name"/>
                    </div>
                    <!-- ขวา -->
                    <t t-if="doc.global_discount">
                        <div style="width: 46%;">
                            <table style="width: 100%; text-align: right;margin-right: 10px">
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        รวมก่อนหักส่วนลด
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        ส่วนลด
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                    <t t-else="">
                        <div style="width: 46%;color: white">
                            <table style="width: 100%; text-align: right;margin-right: 10px">
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                            รวมก่อนหักส่วนลด
                                        </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                            ส่วนลด
                                        </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                </div>
                <div class="row" style="margin-bottom: 2mm;">
                    <div class="col-6" style="margin-top: 40px;">
                        <!--margin-top: 30px;-->
                        <div class="row" style="margin-bottom: 2mm; margin-left: 20px;position: relative; top: 8px;">
                            <!-- PO -->
                            <t t-if="doc.customer_po">
                                <span t-field="doc.customer_po"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                            <!-- Project Name -->
                            <t t-if="doc.project_name and doc.project_name.project_name">
                                <span t-field="doc.project_name.project_name"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                            <!-- Modify Type -->
                            <t t-if="doc.modify_type_txt">
                                <span t-field="doc.modify_type_txt"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                            <!-- Plan Home -->
                            <t t-if="doc.plan_home">
                                <span t-field="doc.plan_home"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                            <!-- Room -->
                            <t t-if="doc.room">
                                <span t-field="doc.room"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; margin-left: 20px;">
                            <table style="width: 50%; text-align: left;">
                                <tr>
                                    <td style="text-align: left;">
                                        <t t-if="doc.narration and len(doc.narration) &gt; 220">
                                            <span t-esc="doc.narration[:220] + '...'"/>
                                        </t>
                                        <t t-if="doc.narration and len(doc.narration) &lt;= 220">
                                            <span t-field="doc.narration"/>
                                        </t>
                                        <t t-if="not doc.narration">
                                            <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 7px;">
                            <div style="margin-left: 90%;">
                                <!-- 25xxxxxxxxxxxxxxx -->
                                <t t-set="total_weight" t-value="sum(ol.product_id.weight for ol in doc.invoice_line_ids if ol.product_id.weight)"/>
                                <!-- <span><t t-esc="total_weight"/></span> -->
                                <span t-esc="'{:,.4f}'.format(float(total_weight))" style="position: relative; top: 11px;"/>
                            </div>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -2px;">
                            <table style="width: 100%; text-align: center;">
                                <tr>
                                    <td style="width: 70%; padding-right: 10px;font-size: 13.67px">
                                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_total), o.currency_id.currency_unit_label)" style="position: relative; top: 20px;"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-6" style="margin-left: -10px;">
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 6px;">
                            <!-- 17xxxxxxxxxxxxxxxxxxxxxx -->
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_untaxed))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <!-- <td style="width: 46%;"></td> -->
                                    <td style="text-align: right;">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                        <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                                                </t>
                                            <t t-if="not amount_by_group[0][1]">
                                                <span style="color: white">-</span>
                                            </t>
                                            <!-- <span t-esc="'{:,.4f}'.format(float(value))"/> -->
                                            <t t-if="value is not None">
                                                <span t-esc="'{:,.2f}'.format(float(value))" style="color: white"/>
                                            </t>
                                            <t t-else="">
                                                <span style="color: white">-</span>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -12px;">
                            <div style="width: 70%; text-align: right;">
                                <t t-if="doc.invoice_line_ids">
                                    <t t-if="doc.invoice_line_ids[0].tax_ids">
                                        <div style="margin-right: 8px; display: inline-block;">
                                            <span t-field="doc.invoice_line_ids[0].tax_ids.amount" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}"/>%
                                        </div>
                                    </t>
                                    <t t-else="">
                                        <span style="color: white">-</span>
                                    </t>
                                </t>
                            </div>
                            <!-- ฝั่งซ้าย: amount_by_group -->
                            <div style="width: 30%;">
                                <table style="width: 94%; text-align: right;">
                                    <tr>
                                        <td style="width: 100px; text-align: right;font-size: 13.67px">
                                            <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                            <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                                <t t-if="amount_by_group[0][1]">
                                                    <t t-set="value" t-value="amount_by_group[0][1]"/>
                                                    <t t-if="value is not None">
                                                        <span t-esc="'{:,.2f}'.format(float(value))"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span>-</span>
                                                    </t>
                                                </t>
                                                <t t-if="not amount_by_group[0][1]">
                                                    <span>-</span>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <span>-</span>
                                            </t>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row" style="margin-top: 5px; margin-bottom: 1mm;">
                            <table style="width: 94%; text-align: left;">
                                <tr>
                                    <td style="width: 30%; text-align: right;color: white">
                                        <span style="color: white">-</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-top: 15px; margin-bottom: 2mm; position: relative; top: -39px;">
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="width: 30%; text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_total))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-left: 70%; justify-content: flex-end; position: relative; top: -28px;">
                    <table style="width: 94%; text-align: right;">
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                                <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                <t t-if="doc.billing_period_id">
                                        BL:
                                    <span t-field="doc.billing_period_id.name"/>
                                </t>
                                <t t-if="not doc.billing_period_id">
                                    <span style="color: white">-</span>
                                </t>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                                <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                <t t-if="doc.billing_place_id">
                                        RE:
                                    <span t-field="doc.billing_place_id.name"/>
                                </t>
                                <t t-if="not doc.billing_place_id">
                                    <span style="color: white">-</span>
                                </t>
                            </td>
                        </tr>
                    </table>
                </div>
                <div style="position: absolute; top: 245px; left: 420px;">
                    <span t-field="doc.name"/>
                </div>
                <!-- อยู่กับที่กลางหน้ากระดาษ -->
                <div style="position: absolute; top: 320px; left: 30%; width: 400px;text-align: center;">
                    <span t-field="doc.user_sale_agreement_employee.name"/>
                    <br/>
                    <!--<span t-field="doc.user_sale_agreement_employee.work_phone"/><br/>-->
                    <span t-field="doc.user_sale_agreement_employee.work_email"/>
                </div>
            </div>
        </div>
    </template>


    <template id="mpf_tax_inv_pp_online_report">
        <t t-call="web.html_container">
            <t t-if="error_message">
                <div style="color:red; font-size:16px; padding:20px;">
                    <strong>ผิดพลาด:</strong> <t t-esc="error_message"/>
                </div>
            </t>
            <t t-if="not error_message">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hdc_account_general_reports.MPF_tax_inv_pp_online_document" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </t>
    </template>

    <template id="MPF_tax_inv_pp_online_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>

        <div class="header" style="font-family: Kanit; font-size: 14px;margin-top: -15px;">
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 50px;margin-left: -15px; width: 70%;position: relative; top: 35px;">
                        <!-- 1xxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order">
                            <t t-if="sale_order.name">
                                <span t-field="sale_order.name"/>
                            </t>
                            <t t-if="not sale_order.name">
                                <span t-field="doc.invoice_origin"/>
                            </t>                      
                        </t>
                        <t t-if="not sale_order">
                            <span t-field="doc.invoice_origin"/>
                        </t>
                    </div>
                    <div class="d-flex" style="margin-top: 50px;">
                    </div>
                </div>
                
                <div class="d-flex" style="margin-left: 5%; position: relative; top: 49px;position: relative; left: 105px;">
                    <div style="margin-top: 30px;margin-left: 15px; width: 70%;">
                       <!-- 2xxxxxxxxxxxxxxxxxxxxxxx -->
                       <t t-if="sale_order and sale_order.partner_invoice_id">
                           <span t-field="sale_order.partner_invoice_id.ref"/>
                           <t t-if="sale_order.partner_invoice_id.cus_doc_id">
                               <span t-field="sale_order.partner_invoice_id.cus_doc_id.name"/>
                           </t>
                       </t>
                       <t t-else="">
                           <span style="color: white">-</span>
                       </t>
                    </div>

                    <!--<div class="d-flex" style="margin-top: 30px;">-->
                    <!--    <span>Page </span>-->
                    <!--    <span class="page"/>-->
                    <!--    /-->
                    <!--    <span class="topage"/>-->
                    <!--</div>-->
                </div>
                
                <!--<div style="margin-top: 5px; margin-left: 100px;color: white">-->
                <!--    3xxxxxxxxxxxxxx-->
                <!--</div>-->
                
                <div class="d-flex" style="margin-left: 70%;position: relative; top: 15px;">
                  <p style="padding: 0px; margin-right: 50px; position: relative; left: -35px;">
                      <t t-if="doc.billing_route_id">
                          <span t-field="doc.billing_route_id.name"/> 
                      </t>
                      <t t-if="not doc.billing_route_id">
                          <span style="color: white">-</span>
                      </t>
                  </p>
              
                  <!-- form_no ตำแหน่งเดิม -->
                  <t t-if="doc.form_no">
                      <span t-field="doc.form_no"/>                      
                  </t>
                  <t t-if="not doc.form_no">
                      <span style="color: white">-</span>
                  </t>
              </div>

                
                <div class="d-flex" style="margin-left: 68%;position: relative; top: 7px;">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;position: relative; left: -25px;">
                         <!-- 3xxxxxxxxxxxxxx -->
                         <t t-if="doc.billing_terms_id.code">
                            <span t-field="doc.billing_terms_id.code"/>                      
                        </t>
                        <t t-if="not doc.billing_terms_id.code">
                            <span style="color: white">-</span>
                        </t>
                    </p>
                </div>
                
                <div class="d-flex" style="margin-left: 10%; position: relative; top: 37px; font-size: 15px">
                    <div class="text-nowrap" style="margin-right: 10px; ">
                        <!-- 4xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.name">
                            <span t-field="sale_order.partner_invoice_id.name"/>                      
                        </t>
                        <t t-if="not (sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.name)">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                    <div style="margin-right: 45%;">
                        <t t-if="sale_order and sale_order.partner_invoice_id">
                            <t t-if="sale_order.partner_invoice_id.is_head_office">
                                 <span t-esc="sale_order.partner_invoice_id.branch_name"/>
                            </t>
                            <t t-else="">
                                <span>
                                    <t t-esc="sale_order.partner_invoice_id.branch_name"/> สาขาที่ <t t-esc="sale_order.partner_invoice_id.branch"/>
                                </span>
                            </t>
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>
                    </div>

                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;position: relative; top: 57px; font-size: 15px">
                        <!-- 5xxxxxxxxxxxxxxxxxxxxxx
                        5.1xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order and sale_order.partner_invoice_id">
                            <span t-field="sale_order.partner_invoice_id.street"/>
                            <span t-field="sale_order.partner_invoice_id.street2"/>
                            <span t-field="sale_order.partner_invoice_id.sub_district"/>
                            <span t-field="sale_order.partner_invoice_id.city"/>
                            <span t-field="sale_order.partner_invoice_id.state_id"/>
                            <span t-field="sale_order.partner_invoice_id.zip"/>
                        </t>
                        <t t-if="not (sale_order and sale_order.partner_invoice_id)">
                            <span style="color: white">-</span>
                        </t>
                        
                    </div>    
                    <div style="padding: 0px; margin: 0px;position: relative; top: 13px;">
                        <!-- 6xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_date">
                            <span t-field="doc.invoice_date"/>
                        </t>
                        <t t-if="not doc.invoice_date">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <!-- 5.2xxxxxxxxxxxxxxxxxxxxxx
                        5.3xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.sale_spec_employee">
                            <span style="position: relative; left: 600px;">Sale Spec</span>
                        </t> -->
                    </div>    
                    <div style="padding: 0px; margin: 0px;width: 200px;position: relative; top: -6px;">
                        <!-- 7xxxxxxxxxxxxxxxxxxxxxx -->
                         <span style="color: white">-</span>
              
                        <!-- <t t-if="doc.sale_spec_employee">
                            <span t-field="doc.sale_spec_employee.name"/>
                        </t>
                        <t t-if="not doc.sale_spec_employee">
                            <span style="color: white">-</span>
                        </t> -->
                    </div>
                </div>
                
                
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.4xxxxxxxxxxxxxxxxxxxxxx
                        5.5xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.invoice_user_employee_id">
                            <span style="position: relative; left: 600px;">Sale Person</span>
                        </t> -->

                         <t t-if="doc.sale_spec_employee">
                            <span style="position: relative; left: 600px;">Spec</span>
                        </t>
                    </div>     
                    <div style="padding: 0px; margin: 0px;width: 200px; position: relative; top: -1px;">
                        <!-- 8xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.invoice_user_employee_id">
                            <span t-field="doc.invoice_user_employee_id.name"/>/<span t-field="doc.invoice_user_employee_id.phone"/>
                        </t>
                        <t t-if="not doc.invoice_user_employee_id">
                            <span style="color: white">-</span>
                        </t> -->

                        <t t-if="doc.sale_spec_employee">
                            <span t-field="doc.sale_spec_employee.name"/>/<span t-field="doc.sale_spec_employee.phone"/>
                        </t>
                        <t t-if="not doc.sale_spec_employee">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.6xxxxxxxxxxxxxxxxxxxxxx
                        5.7xxxxxxxxxxxxxxxxxxxxxx -->
                    </div>     
                    <div class="text-nowrap" style="padding: 0px; margin: 0px;width: 200px; position: relative; top: 1px;">
                        <!-- 9xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.team_id">
                            <span t-field="doc.team_id.name"/>
                        </t>
                        <t t-if="not doc.team_id">
                            <span style="color: white">-</span>
                        </t> -->

                        <t t-if="doc.invoice_user_employee_id">
                            <span t-field="doc.invoice_user_employee_id.name"/>/<span t-field="doc.invoice_user_employee_id.phone"/>
                        </t>
                        <t t-if="not doc.invoice_user_employee_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                    </div>     
                    <div style="padding: 0px; margin: 0px;text-align: center;width: 200px;position: relative; top: 9px;position: relative; left: 40px;">
                       <t t-if="sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.vat">
                            <span t-field="sale_order.partner_invoice_id.vat"/>
                        </t>
                        <t t-if="not (sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.vat)">
                            -
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;position: relative; top: -8px;">
                        <!-- 10xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.phone">
                            โทร: <span t-field="sale_order.partner_invoice_id.phone"/>
                        </t>
                        <t t-if="sale_order and sale_order.partner_invoice_id and sale_order.partner_invoice_id.fax">
                            โทรสาร: <span t-field="sale_order.partner_invoice_id.fax"/>
                        </t>
                        <t t-if="not (sale_order and sale_order.partner_invoice_id and (sale_order.partner_invoice_id.phone or sale_order.partner_invoice_id.fax))">
                            <span style="color: white">-</span>
                        </t>

                    </div>     
                    <div style="padding: 0px; margin: 0px;margin-left: -18px;text-align: center;width: 200px;position: relative; top: 15px;position: relative; left: 40px;">
                        <!-- 11xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_payment_term_id">
                            <span t-field="doc.invoice_payment_term_id.name"/>
                        </t>
                        <t t-if="not doc.invoice_payment_term_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>

            </div>
            <div>
              <div class="row" style="height: 33px">
                <span style="color: white">-</span>
              </div>
            </div>
        </div>
        
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
          <style>
            thead th {
              height: 57px;
            }
          </style>
            <!--<div style="margin-top: 100px;">-->
              <div class="row">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 12.67px;line-height: 14px;">
                    <thead style="height: 30px">
                      <tr>
                        <th class="text-center" style="width: 3%;color: white">1</th>
                        <th class="text-center" style="width: 50%;color: white">2</th>
                        <th class="text-center" style="width: 5%;color: white">3</th>
                        <th class="text-center" style="width: 10%;color: white">4</th>
                        <th class="text-center" style="width: 4%;color: white">5</th>
                        <th class="text-center" style="width: 12%;color: white">6</th>
                        <th class="text-center" style="width: 16%;color: white">7</th>
                      </tr>
                    </thead>
                    <tbody style="font-size: 12.67px">
                        <t t-foreach="doc.invoice_line_ids.sorted(key=lambda l: l.sequence)" t-as="ol">
                            <!-- กรณีบรรทัดประเภทหัวข้อ/หมายเหตุ -->
                            <t t-if="ol.display_type in ['line_section', 'line_note']">
                                <tr>
                                    <td></td>
                                    <td colspan="6" class="text-left">
                                    <t t-if="ol.display_type == 'line_note'">
                                        <em><span t-field="ol.name"/></em>
                                    </t>
                                    <t t-elif="ol.display_type == 'line_section'">
                                        <strong><span t-field="ol.name"/></strong>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                    </td>
                                </tr>
                            </t>

                            <!-- กรณีบรรทัดสินค้าปกติ -->
                            <t t-else="">
                                <tr>
                                    <td class="text-center">
                                        <t t-if="not ol.is_component">
                                            <t t-set="l_no" t-value="l_no + 1"/>
                                            <t t-esc="l_no"/>
                                        </t>
                                    </td>

                                    <!-- คอลัมน์ชื่อสินค้า ตาม form_label_type -->
                                    <t t-if="doc.form_label_type == 'label'">
                                        <td class="text-left">
                                            <span t-if="ol.name"><span t-field="ol.name"/></span>
                                            <span t-if="not ol.name">-</span>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'name'">
                                        <td class="text-left">
                                            <span t-if="ol.product_id.name"><span t-field="ol.product_id.name"/></span>
                                            <span t-if="not ol.product_id.name">-</span>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'ref_name'">
                                        <td class="text-left">
                                            <span t-field="ol.product_id.default_code"/> <span t-field="ol.name"/>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'barcode_name'">
                                        <td class="text-left">
                                            <span t-field="ol.product_id.barcode"/> <span t-field="ol.name"/>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'external_code_name'">
                                        <t t-set="filtered_barcodes"
                                            t-value="ol.product_id.product_tmpl_id.barcode_spe_ids.filtered(lambda b: b.partner_id == doc.partner_id and b.product_tmpl_id == ol.product_id.product_tmpl_id)"/>
                                        <td class="text-left">
                                            <t t-if="filtered_barcodes">
                                            <t t-foreach="filtered_barcodes" t-as="barcode1">
                                                <span t-field="barcode1.external_code"/>
                                                <span t-field="barcode1.external_description"/>
                                            </t>
                                            <!--<span t-field="ol.external_description"/>-->
                                            </t>
                                            <t t-else="">-</t>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'external_desc_name'">
                                        <t t-set="filtered_barcodes"
                                            t-value="ol.product_id.product_tmpl_id.barcode_spe_ids.filtered(lambda b: b.partner_id == doc.partner_id and b.product_tmpl_id == ol.product_id.product_tmpl_id)"/>
                                        <td class="text-left">
                                            <t t-if="filtered_barcodes">
                                                <t t-foreach="filtered_barcodes" t-as="barcode1">
                                                    <span t-field="barcode1.external_description"/>
                                                </t>
                                                <span t-field="ol.name"/>
                                            </t>
                                            <t t-else="">-</t>
                                        </td>
                                    </t>
                                    <t t-else="">
                                    <td class="text-left">
                                        <span t-if="ol.name">
                                        <span t-field="ol.product_id.default_code"/> <span t-field="ol.name"/></span>
                                        <span t-if="not ol.name">-</span>
                                    </td>
                                    </t>
                                        <td class="text-left text-nowrap" style="position:relative; left: -9px;">
                                        <span style="display:inline-block; width:47px; text-align:left;">
                                        <t t-esc="(ol.triple_discount or '').replace('+', ',')"/>
                                        </span>
                                    </td>
                                            
                                            
                                            
                                    <td class="text-right" style="position:relative; left:-7px;">
                                        <t t-if="ol.quantity">
                                            <t t-set="qty" t-value="float(ol.quantity)"/>
                                            <t t-if="qty.is_integer()">
                                            <!-- เป็นจำนวนเต็ม เช่น 10.00 => แสดง 10 -->
                                            <span t-esc="'{:,.0f}'.format(qty)"/>
                                            </t>
                                            <t t-else="">
                                            <!-- มีทศนิยม เช่น 10.30 => แสดง 10.30 -->
                                            <span t-esc="'{:,.2f}'.format(qty)"/>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>

                                    <td class="text-right">
                                        <span t-if="ol.product_uom_id.name"><span t-field="ol.product_uom_id.name"/></span>
                                        <span t-if="not ol.product_uom_id.name">-</span>
                                    </td>
                                    <td class="text-right">
                                        <span t-if="ol.price_unit"><span t-esc="'{:,.4f}'.format(float(ol.price_unit))"/></span>
                                        <span t-if="not ol.price_unit">-</span>
                                    </td>
                                    <td class="text-right">
                                        <!-- <span t-if="ol.price_subtotal"><span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/></span>
                                        <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span> -->
                                        <t t-if="ol.tax_ids and ol.tax_ids[0].price_include">
                                            <span t-if="ol.price_total">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_total))" style="margin-right:3px;"/>
                                            </span>
                                            <span t-if="not ol.price_total" style="margin-right:3px;">-</span>
                                        </t>
                                        <t t-else="">
                                            <span t-if="ol.price_subtotal">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/>
                                            </span>
                                            <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="footer last-page" style="font-size: 12.67px;font-family: Kanit;">
            <div>
                <!--<div class="d-flex">-->
                <!--  <span style="color: white">1</span>-->
                <!--</div>-->

                <div style="position: absolute; top: 1px; left: 420px;font-size: 30.67px;">
                    <!-- 16xxxxxxxxxxxxxxx -->
                    <t t-if="doc.document_stamp_state_id">
                        <span t-field="doc.document_stamp_state_id.name"/>
                    </t>
                    <t t-if="not doc.document_stamp_state_id">
                        <span style="color: white">-</span>
                    </t>
                </div>
                
                <div class="row" style="justify-content: space-between; align-items: flex-start;position: relative; top: 36px;">
                    <!-- ซ้าย -->
                    <div style="margin-left: 20px; width: 50%;">
                         <!--สายส่ง: <span t-field="doc.transport_desc"/>  <span t-field="doc.company_round_desc"/>-->
                        สายส่ง: <span t-field="doc.transport_line_id.name"/>  <span t-field="doc.company_round_id.name"/>
                    </div>
                
                    <!-- ขวา -->
                    <t t-if="doc.global_discount">
                      <div style="width: 46%;">
                          <table style="width: 100%; text-align: right;margin-right: 10px">
                              <tr>
                                  <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                      รวมก่อนหักส่วนลด
                                  </td>
                                  <td style="width: 100px;font-size: 13.67px">
                                      <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                  </td>
                              </tr>
                              <tr>
                                  <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                      ส่วนลด
                                  </td>
                                  <td style="width: 100px;font-size: 13.67px">
                                      <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                  </td>
                              </tr>
                          </table>
                      </div>
                  </t>
                   <t t-else="">
                        <div style="width: 46%;color: white">
                            <table style="width: 100%; text-align: right;margin-right: 10px">
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        รวมก่อนหักส่วนลด
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        ส่วนลด
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                  
                </div>



                <div class="row" style="margin-bottom: 2mm;">
                    <div class="col-6" style="margin-top: 40px;">
                        <!--margin-top: 30px;-->
                        
                        <div class="row" style="margin-bottom: 2mm; margin-left: 20px;position: relative; top: 8px;">
                            <!-- PO -->
                            <t t-if="doc.customer_po">
                                <span t-field="doc.customer_po"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Project Name -->
                            <t t-if="doc.project_name and doc.project_name.project_name">
                                <span t-field="doc.project_name.project_name"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Modify Type -->
                            <t t-if="doc.modify_type_txt">
                                <span t-field="doc.modify_type_txt"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Plan Home -->
                            <t t-if="doc.plan_home">
                                <span t-field="doc.plan_home"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Room -->
                            <t t-if="doc.room">
                                <span t-field="doc.room"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                        </div>
                                                <div class="row" style="margin-bottom: 2mm; margin-left: 20px;">
                            <table style="width: 50%; text-align: left;">
                                <tr>
                                    <td style="text-align: left;">
                                        <t t-if="doc.narration and len(doc.narration) &gt; 220">
                                            <span t-esc="doc.narration[:220] + '...'"/>
                                        </t>
                                        <t t-if="doc.narration and len(doc.narration) &lt;= 220">
                                            <span t-field="doc.narration"/>
                                        </t>
                                        <t t-if="not doc.narration">
                                            <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 7px;">
                            <div style="margin-left: 90%;">
                                <!-- 25xxxxxxxxxxxxxxx -->
                                <t t-set="total_weight" t-value="sum(ol.product_id.weight for ol in doc.invoice_line_ids if ol.product_id.weight)"/>
                                <t t-if="total_weight">
                                    <span t-esc="'{:,.4f}'.format(float(total_weight))" style="position: relative; top: 11px;"/>
                                </t>
                                <t t-if="not total_weight">
                                    <span style="color: white">-</span>
                                </t>
                            </div>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -2px;">
                            <table style="width: 100%; text-align: center;">
                                <tr>
                                    <td style="width: 70%; padding-right: 10px;font-size: 13.67px">
                                        <span t-esc="doc.currency_id.amount_to_text_th(abs(doc.amount_total), o.currency_id.currency_unit_label)" style="position: relative; top: 20px;"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-6" style="margin-left: -10px;">
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 6px;">
                            <!-- 17xxxxxxxxxxxxxxxxxxxxxx -->
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_untaxed))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <!-- <td style="width: 46%;"></td> -->
                                    <td style="text-align: right;">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                        <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                            <t t-set="value" t-value="amount_by_group[0][1]"/>
                                            </t>
                                            <t t-if="not amount_by_group[0][1]">
                                              <span style="color: white">-</span>
                                            </t>
                                            <!-- <span t-esc="'{:,.4f}'.format(float(value))"/> -->
                                            <t t-if="value is not None">
                                                <span t-esc="'{:,.2f}'.format(float(value))" style="color: white"/>
                                            </t>
                                            <t t-else="">
                                                <span style="color: white">-</span>
                                            </t>

                                        </t>
                                        <t t-else="">
                                           <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -12px;">

                          <div style="width: 70%; text-align: right;">
                              <t t-if="doc.invoice_line_ids">
                                  <t t-if="doc.invoice_line_ids[0].tax_ids">
                                    <div style="margin-right: 8px; display: inline-block;">
                                        <span t-field="doc.invoice_line_ids[0].tax_ids.amount" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}"/>%
                                    </div>
                                  </t>
                                  <t t-else="">
                                     <span style="color: white">-</span>
                                  </t>
                              </t>
                          </div>
                          <!-- ฝั่งซ้าย: amount_by_group -->
                          <div style="width: 30%;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <td style="width: 100px; text-align: right;font-size: 13.67px">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                        <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                                                <t t-if="value is not None">
                                                    <span t-esc="'{:,.2f}'.format(float(value))"/>
                                                </t>
                                                <t t-else="">
                                                    <span>-</span>
                                                </t>
                                            </t>
                                            <t t-if="not amount_by_group[0][1]">
                                                <span>-</span>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                      </div>
                      
                        <div class="row" style="margin-top: 5px; margin-bottom: 1mm;">
                            <table style="width: 94%; text-align: left;">
                                <tr>
                                    <td style="width: 30%; text-align: right;color: white">
                                       <span style="color: white">-</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <div class="row" style="margin-top: 15px; margin-bottom: 2mm; position: relative; top: -39px;">
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="width: 30%; text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_total))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </div>

                <div class="row" style="margin-left: 70%; justify-content: flex-end; position: relative; top: -28px;">
                    <table style="width: 94%; text-align: right;">
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                              <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                  <t t-if="doc.billing_period_id">
                                      BL: <span t-field="doc.billing_period_id.name"/> 
                                  </t>
                                  <t t-if="not doc.billing_period_id">
                                      <span style="color: white">-</span>
                                  </t>
                              
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                              <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                <t t-if="doc.billing_place_id">
                                    RE: <span t-field="doc.billing_place_id.name"/> 
                                </t>
                                <t t-if="not doc.billing_place_id">
                                    <span style="color: white">-</span>
                                </t>
                                  
                            </td>
                        </tr>
                    </table>
                </div>



               <div style="position: absolute; top: 245px; left: 420px;">
                    <span t-field="doc.name"/>
                </div>

                <!-- อยู่กับที่กลางหน้ากระดาษ -->
              <div style="position: absolute; top: 320px; left: 30%; width: 400px;text-align: center;">
                  <span t-field="doc.user_sale_agreement_employee.name"/><br/>
                  <!--<span t-field="doc.user_sale_agreement_employee.work_phone"/><br/>-->
                  <span t-field="doc.user_sale_agreement_employee.work_email"/>
              </div>

            </div>
        </div>

    </template>


    <template id="mpf_tax_inv_pp_eng_report">
        <t t-call="web.html_container">
            <t t-if="error_message">
                <div style="color:red; font-size:16px; padding:20px;">
                    <strong>ผิดพลาด:</strong> <t t-esc="error_message"/>
                </div>
            </t>
            <t t-if="not error_message">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hdc_account_general_reports.MPF_tax_inv_pp_eng_document" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </t>
    </template>

    <template id="MPF_tax_inv_pp_eng_document">
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <t t-set="sale_order" t-value="doc.env['sale.order'].search([('name', '=', doc.invoice_origin)])"/>

        <div class="header" style="font-family: Kanit; font-size: 14px;margin-top: -15px;">
            <div style="">
                <div class="d-flex" style="margin-left: 5%;">
                    <div style="margin-top: 50px;margin-left: -15px; width: 70%;position: relative; top: 35px;">
                        <!-- 1xxxxxxxxxxxxxxxx -->
                        <t t-if="sale_order">
                            <t t-if="sale_order.name">
                                <span t-field="sale_order.name"/>
                            </t>
                            <t t-if="not sale_order.name">
                                <span t-field="doc.invoice_origin"/>
                            </t>                      
                        </t>
                        <t t-if="not sale_order">
                            <span t-field="doc.invoice_origin"/>
                        </t>
                    </div>
                    <div class="d-flex" style="margin-top: 50px;">
                    </div>
                </div>
                
                <div class="d-flex" style="margin-left: 5%; position: relative; top: 49px;position: relative; left: 105px;">
                    <div style="margin-top: 30px;margin-left: 15px; width: 70%;">
                       <!-- 2xxxxxxxxxxxxxxxxxxxxxxx -->
                       <span t-field="doc.partner_id.ref"/>  <span t-field="doc.partner_id.cus_doc_id.name"/>
                    </div>

                    <!--<div class="d-flex" style="margin-top: 30px;">-->
                    <!--    <span>Page </span>-->
                    <!--    <span class="page"/>-->
                    <!--    /-->
                    <!--    <span class="topage"/>-->
                    <!--</div>-->
                </div>
                
                <!--<div style="margin-top: 5px; margin-left: 100px;color: white">-->
                <!--    3xxxxxxxxxxxxxx-->
                <!--</div>-->
                
                <div class="d-flex" style="margin-left: 70%;position: relative; top: 15px;">
                  <p style="padding: 0px; margin-right: 50px; position: relative; left: -35px;">
                      <t t-if="doc.billing_route_id">
                          <span t-field="doc.billing_route_id.name"/> 
                      </t>
                      <t t-if="not doc.billing_route_id">
                          <span style="color: white">-</span>
                      </t>
                  </p>
              
                  <!-- form_no ตำแหน่งเดิม -->
                  <t t-if="doc.form_no">
                      <span t-field="doc.form_no"/>                      
                  </t>
                  <t t-if="not doc.form_no">
                      <span style="color: white">-</span>
                  </t>
              </div>

                
                <div class="d-flex" style="margin-left: 68%;position: relative; top: 7px;">
                    <!-- <p style="padding: 0px; margin-right: 30px;">[3] - Billing Route</p> -->
                    <p style="padding: 0px; margin-right: 50px;position: relative; left: -25px;">
                         <!-- 3xxxxxxxxxxxxxx -->
                         <t t-if="doc.billing_terms_id.code">
                            <span t-field="doc.billing_terms_id.code"/>                      
                        </t>
                        <t t-if="not doc.billing_terms_id.code">
                            <span style="color: white">-</span>
                        </t>
                    </p>
                </div>
                
                <div class="d-flex" style="margin-left: 10%; position: relative; top: 37px; font-size: 15px">
                    <div class="text-nowrap" style="margin-right: 10px; ">
                        <!-- 4xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.partner_id.name_eng">
                            <span t-field="doc.partner_id.name_eng"/>                      
                        </t>
                        <t t-if="not doc.partner_id.name_eng">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                    <div style="margin-right: 45%;">
                        <t t-if="doc.partner_id">
                            <t t-if="doc.partner_id.is_head_office">
                                 <span t-esc="doc.partner_id.branch_name"/>
                            </t>
                            <t t-else="">
                                <span>
                                    <t t-esc="doc.partner_id.branch_name"/> Branch <t t-esc="doc.partner_id.branch"/>
                                </span>
                            </t>
                        </t>
                        <t t-else="">
                            <span style="color: white">-</span>
                        </t>
                    </div>

                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;position: relative; top: 57px; font-size: 15px">
                        <!-- 5xxxxxxxxxxxxxxxxxxxxxx
                        5.1xxxxxxxxxxxxxxxxxxxxxx -->
                        <span t-field="doc.partner_id.street"/>
                        <span t-field="doc.partner_id.street2"/>
                        <span t-field="doc.partner_id.sub_district"/>
                        <span t-field="doc.partner_id.city"/>
                        <span t-field="doc.partner_id.state_id"/>
                        <span t-field="doc.partner_id.zip"/>
                        
                    </div>    
                    <div style="padding: 0px; margin: 0px;position: relative; top: 13px;">
                        <!-- 6xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_date">
                            <span t-field="doc.invoice_date"/>
                        </t>
                        <t t-if="not doc.invoice_date">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%;width: 400px;">
                        <!-- 5.2xxxxxxxxxxxxxxxxxxxxxx
                        5.3xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.sale_spec_employee">
                            <span style="position: relative; left: 600px;">Sale Spec</span>
                        </t> -->
                    </div>    
                    <div style="padding: 0px; margin: 0px;width: 200px;position: relative; top: -6px;">
                        <!-- 7xxxxxxxxxxxxxxxxxxxxxx -->
                        <span style="color: white">-</span>
              
                        <!-- <t t-if="doc.sale_spec_employee">
                            <span t-field="doc.sale_spec_employee.name"/>
                        </t>
                        <t t-if="not doc.sale_spec_employee">
                            <span style="color: white">-</span>
                        </t> -->
                    </div>
                </div>
                
                
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.4xxxxxxxxxxxxxxxxxxxxxx
                        5.5xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.invoice_user_employee_id">
                            <span style="position: relative; left: 600px;">Sale Person</span>
                        </t> -->

                         <t t-if="doc.sale_spec_employee">
                            <span style="position: relative; left: 600px;">Spec</span>
                        </t>
                    </div>     
                    <div style="padding: 0px; margin: 0px;width: 200px; position: relative; top: -1px;">
                        <!-- 8xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.invoice_user_employee_id">
                            <span t-field="doc.invoice_user_employee_id.name"/>/<span t-field="doc.invoice_user_employee_id.phone"/>
                        </t>
                        <t t-if="not doc.invoice_user_employee_id">
                            <span style="color: white">-</span>
                        </t> -->

                         <t t-if="doc.sale_spec_employee">
                            <span t-field="doc.sale_spec_employee.name"/>/<span t-field="doc.sale_spec_employee.phone"/>
                        </t>
                        <t t-if="not doc.sale_spec_employee">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                        <!-- 5.6xxxxxxxxxxxxxxxxxxxxxx
                        5.7xxxxxxxxxxxxxxxxxxxxxx -->
                    </div>     
                    <div class="text-nowrap" style="padding: 0px; margin: 0px;width: 200px; position: relative; top: 1px;">
                        <!-- 9xxxxxxxxxxxxxxxxxxxxxx -->
                        <!-- <t t-if="doc.team_id">
                            <span t-field="doc.team_id.name"/>
                        </t>
                        <t t-if="not doc.team_id">
                            <span style="color: white">-</span>
                        </t> -->

                         <t t-if="doc.invoice_user_employee_id">
                            <span t-field="doc.invoice_user_employee_id.name"/>/<span t-field="doc.invoice_user_employee_id.phone"/>
                        </t>
                        <t t-if="not doc.invoice_user_employee_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;">
                    </div>     
                    <div style="padding: 0px; margin: 0px;text-align: center;width: 200px;position: relative; top: 9px;position: relative; left: 40px;">
                       <t t-if="doc.partner_id.vat">
                            <span t-field="doc.partner_id.vat"/>
                        </t>
                        <t t-if="not doc.partner_id.vat">
                            -
                        </t>
                    </div>
                </div>
                
                <div class="d-flex">
                    <div class="d-flex" style="margin-right: 30%; width: 400px;position: relative; top: -8px;">
                        <!-- 10xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.partner_id.phone">Tel: <span t-field="doc.partner_id.phone"/></t> <t t-if="doc.partner_id.fax">Fax: <span t-field="doc.partner_id.fax"/></t>

                    </div>     
                    <div style="padding: 0px; margin: 0px;margin-left: -18px;text-align: center;width: 200px;position: relative; top: 15px;position: relative; left: 40px;">
                        <!-- 11xxxxxxxxxxxxxxxxxxxxxx -->
                        <t t-if="doc.invoice_payment_term_id">
                            <span t-field="doc.invoice_payment_term_id.name"/>
                        </t>
                        <t t-if="not doc.invoice_payment_term_id">
                            <span style="color: white">-</span>
                        </t>
                    </div>
                </div>

            </div>
            <div>
              <div class="row" style="height: 33px">
                <span style="color: white">-</span>
              </div>
            </div>
        </div>
        
        <div class="article" style="font-family: Kanit; border: 2px solid white;">
          <style>
            thead th {
              height: 57px;
            }
          </style>
            <!--<div style="margin-top: 100px;">-->
              <div class="row">
                <t t-set="l_no" t-value="0"/>
                <table class="table table-borderless" style="font-size: 12.67px;line-height: 14px;">
                    <thead style="height: 30px">
                      <tr>
                        <th class="text-center" style="width: 3%;color: white">1</th>
                        <th class="text-center" style="width: 50%;color: white">2</th>
                        <th class="text-center" style="width: 5%;color: white">3</th>
                        <th class="text-center" style="width: 10%;color: white">4</th>
                        <th class="text-center" style="width: 4%;color: white">5</th>
                        <th class="text-center" style="width: 12%;color: white">6</th>
                        <th class="text-center" style="width: 16%;color: white">7</th>
                      </tr>
                    </thead>
                    <tbody style="font-size: 12.67px">
                        <t t-foreach="doc.invoice_line_ids.sorted(key=lambda l: l.sequence)" t-as="ol">
                            <!-- กรณีบรรทัดประเภทหัวข้อ/หมายเหตุ -->
                            <t t-if="ol.display_type in ['line_section', 'line_note']">
                                <tr>
                                    <td></td>
                                    <td colspan="6" class="text-left">
                                    <t t-if="ol.display_type == 'line_note'">
                                        <em><span t-field="ol.name"/></em>
                                    </t>
                                    <t t-elif="ol.display_type == 'line_section'">
                                        <strong><span t-field="ol.name"/></strong>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                    </td>
                                </tr>
                            </t>

                            <!-- กรณีบรรทัดสินค้าปกติ -->
                            <t t-else="">
                                <tr>
                                    <td class="text-center">
                                        <t t-if="not ol.is_component">
                                            <t t-set="l_no" t-value="l_no + 1"/>
                                            <t t-esc="l_no"/>
                                        </t>
                                    </td>

                                    <!-- คอลัมน์ชื่อสินค้า ตาม form_label_type -->
                                    <t t-if="doc.form_label_type == 'label'">
                                        <td class="text-left">
                                            <span t-if="ol.product_id.item_eng"><span t-field="ol.product_id.item_eng"/></span>
                                            <span t-if="not ol.product_id.item_eng">-</span>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'name'">
                                        <td class="text-left">
                                            <span t-if="ol.product_id.item_eng"><span t-field="ol.product_id.item_eng"/></span>
                                            <span t-if="not ol.product_id.item_enge">-</span>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'ref_name'">
                                        <td class="text-left">
                                            <span t-field="ol.product_id.default_code"/> <span t-field="ol.product_id.item_eng"/>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'barcode_name'">
                                        <td class="text-left">
                                            <span t-field="ol.product_id.barcode"/> <span t-field="ol.product_id.item_eng"/>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'external_code_name'">
                                        <t t-set="filtered_barcodes"
                                            t-value="ol.product_id.product_tmpl_id.barcode_spe_ids.filtered(lambda b: b.partner_id == doc.partner_id and b.product_tmpl_id == ol.product_id.product_tmpl_id)"/>
                                        <td class="text-left">
                                            <t t-if="filtered_barcodes">
                                            <t t-foreach="filtered_barcodes" t-as="barcode1">
                                                <span t-field="barcode1.external_code"/>
                                                <span t-field="barcode1.external_description"/>
                                            </t>
                                            <!--<span t-field="ol.external_description"/>-->
                                            </t>
                                            <t t-else="">-</t>
                                        </td>
                                    </t>
                                    <t t-elif="doc.form_label_type == 'external_desc_name'">
                                        <t t-set="filtered_barcodes"
                                            t-value="ol.product_id.product_tmpl_id.barcode_spe_ids.filtered(lambda b: b.partner_id == doc.partner_id and b.product_tmpl_id == ol.product_id.product_tmpl_id)"/>
                                        <td class="text-left">
                                            <t t-if="filtered_barcodes">
                                                <t t-foreach="filtered_barcodes" t-as="barcode1">
                                                    <span t-field="barcode1.external_description"/>
                                                </t>
                                                <span t-field="ol.name"/>
                                            </t>
                                            <t t-else="">-</t>
                                        </td>
                                    </t>
                                    <t t-else="">
                                    <td class="text-left">
                                        <span t-if="ol.product_id.item_eng">
                                        <span t-field="ol.product_id.default_code"/> <span t-field="ol.product_id.item_eng"/></span>
                                        <span t-if="not ol.product_id.item_eng">-</span>
                                    </td>
                                    </t>
                                        <td class="text-left text-nowrap" style="position:relative; left: -9px;">
                                        <span style="display:inline-block; width:47px; text-align:left;">
                                        <t t-esc="(ol.triple_discount or '').replace('+', ',')"/>
                                        </span>
                                    </td>
                                            
                                            
                                            
                                    <td class="text-right" style="position:relative; left:-7px;">
                                        <t t-if="ol.quantity">
                                            <t t-set="qty" t-value="float(ol.quantity)"/>
                                            <t t-if="qty.is_integer()">
                                            <!-- เป็นจำนวนเต็ม เช่น 10.00 => แสดง 10 -->
                                            <span t-esc="'{:,.0f}'.format(qty)"/>
                                            </t>
                                            <t t-else="">
                                            <!-- มีทศนิยม เช่น 10.30 => แสดง 10.30 -->
                                            <span t-esc="'{:,.2f}'.format(qty)"/>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>

                                    <td class="text-right">
                                        <span t-if="ol.product_uom_id.name"><span t-field="ol.product_uom_id.with_context(lang='en_US').name"/></span>
                                        <span t-if="not ol.product_uom_id.name">-</span>
                                    </td>
                                    <td class="text-right">
                                        <span t-if="ol.price_unit"><span t-esc="'{:,.4f}'.format(float(ol.price_unit))"/></span>
                                        <span t-if="not ol.price_unit">-</span>
                                    </td>
                                    <td class="text-right">
                                        <!-- <span t-if="ol.price_subtotal"><span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/></span>
                                        <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span> -->
                                        <t t-if="ol.tax_ids and ol.tax_ids[0].price_include">
                                            <span t-if="ol.price_total">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_total))" style="margin-right:3px;"/>
                                            </span>
                                            <span t-if="not ol.price_total" style="margin-right:3px;">-</span>
                                        </t>
                                        <t t-else="">
                                            <span t-if="ol.price_subtotal">
                                            <span t-esc="'{:,.2f}'.format(float(ol.price_subtotal))" style="margin-right:3px;"/>
                                            </span>
                                            <span t-if="not ol.price_subtotal" style="margin-right:3px;">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="footer last-page" style="font-size: 12.67px;font-family: Kanit;">
            <div>
                <!--<div class="d-flex">-->
                <!--  <span style="color: white">1</span>-->
                <!--</div>-->

                <div style="position: absolute; top: 1px; left: 420px;font-size: 30.67px;">
                    <!-- 16xxxxxxxxxxxxxxx -->
                    <t t-if="doc.document_stamp_state_id">
                        <span t-field="doc.document_stamp_state_id.name"/>
                    </t>
                    <t t-if="not doc.document_stamp_state_id">
                        <span style="color: white">-</span>
                    </t>
                </div>
                
                <div class="row" style="justify-content: space-between; align-items: flex-start;position: relative; top: 36px;">
                    <!-- ซ้าย -->
                    <div style="margin-left: 20px; width: 50%;">
                        <!-- <span t-field="doc.company_round_id.name"/> -->
                        <span t-field="doc.transport_line_id.name"/>  <span t-field="doc.company_round_id.name"/>
                    </div>

                    <!-- ขวา -->
                    <t t-if="doc.global_discount">
                      <div style="width: 46%;">
                          <table style="width: 100%; text-align: right;margin-right: 10px">
                              <tr>
                                  <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                      Global Discount
                                  </td>
                                  <td style="width: 100px;font-size: 13.67px">
                                      <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                  </td>
                              </tr>
                              <tr>
                                  <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                      Discount
                                  </td>
                                  <td style="width: 100px;font-size: 13.67px">
                                      <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                  </td>
                              </tr>
                          </table>
                      </div>
                  </t>
                   <t t-else="">
                        <div style="width: 46%;color: white">
                            <table style="width: 100%; text-align: right;margin-right: 10px">
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        Global Discount
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_before_discount))"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 0px; text-align: right; padding-right: 40px;">
                                        Discount
                                    </td>
                                    <td style="width: 100px;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.total_discount_amount_new))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                  
                </div>



                <div class="row" style="margin-bottom: 2mm;">
                    <div class="col-6" style="margin-top: 40px;">
                        <!--margin-top: 30px;-->
                        
                        <div class="row" style="margin-bottom: 2mm; margin-left: 20px;position: relative; top: 8px;">
                            <!-- PO -->
                            <t t-if="doc.customer_po">
                                <span t-field="doc.customer_po"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Project Name -->
                            <t t-if="doc.project_name and doc.project_name.project_name">
                                <span t-field="doc.project_name.project_name"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Modify Type -->
                            <t t-if="doc.modify_type_txt">
                                <span t-field="doc.modify_type_txt"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Plan Home -->
                            <t t-if="doc.plan_home">
                                <span t-field="doc.plan_home"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>

                            <!-- Room -->
                            <t t-if="doc.room">
                                <span t-field="doc.room"/>
                            </t>
                            <t t-else="">
                                <span style="color: white">-</span>
                            </t>
                        </div>
                                                <div class="row" style="margin-bottom: 2mm; margin-left: 20px;">
                            <table style="width: 50%; text-align: left;">
                                <tr>
                                    <td style="text-align: left;">
                                        <t t-if="doc.narration and len(doc.narration) &gt; 220">
                                            <span t-esc="doc.narration[:220] + '...'"/>
                                        </t>
                                        <t t-if="doc.narration and len(doc.narration) &lt;= 220">
                                            <span t-field="doc.narration"/>
                                        </t>
                                        <t t-if="not doc.narration">
                                            <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 7px;">
                            <div style="margin-left: 90%;">
                                <!-- 25xxxxxxxxxxxxxxx -->
                                <t t-set="total_weight" t-value="sum(ol.product_id.weight for ol in doc.invoice_line_ids if ol.product_id.weight)"/>
                                <t t-if="total_weight">
                                    <span t-esc="'{:,.4f}'.format(float(total_weight))" style="position: relative; top: 11px;"/>
                                </t>
                                <t t-if="not total_weight">
                                    <span style="color: white">-</span>
                                </t>
                            </div>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -2px;">
                            <table style="width: 100%; text-align: center;">
                                <tr>
                                    <td style="width: 70%; padding-right: 10px;font-size: 13.67px">
                                        <span t-esc="doc.currency_id.amount_to_text_en(abs(doc.amount_total), o.currency_id.currency_unit_label)" style="position: relative; top: 20px;"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-6" style="margin-left: -10px;">
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <span style="width: 100px; text-align: left; color: white;">-</span>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: 6px;">
                            <!-- 17xxxxxxxxxxxxxxxxxxxxxx -->
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_untaxed))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <!-- <td style="width: 46%;"></td> -->
                                    <td style="text-align: right;">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                        <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                            <t t-set="value" t-value="amount_by_group[0][1]"/>
                                            </t>
                                            <t t-if="not amount_by_group[0][1]">
                                              <span style="color: white">-</span>
                                            </t>
                                            <!-- <span t-esc="'{:,.4f}'.format(float(value))"/> -->
                                            <t t-if="value is not None">
                                                <span t-esc="'{:,.2f}'.format(float(value))" style="color: white"/>
                                            </t>
                                            <t t-else="">
                                                <span style="color: white">-</span>
                                            </t>

                                        </t>
                                        <t t-else="">
                                           <span style="color: white">-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" style="margin-bottom: 2mm; position: relative; top: -12px;">

                          <div style="width: 70%; text-align: right;">
                              <t t-if="doc.invoice_line_ids">
                                  <t t-if="doc.invoice_line_ids[0].tax_ids">
                                    <div style="margin-right: 8px; display: inline-block;">
                                        <span t-field="doc.invoice_line_ids[0].tax_ids.amount" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}"/>%
                                    </div>
                                  </t>
                                  <t t-else="">
                                     <span style="color: white">-</span>
                                  </t>
                              </t>
                          </div>
                          <!-- ฝั่งซ้าย: amount_by_group -->
                          <div style="width: 30%;">
                            <table style="width: 94%; text-align: right;">
                                <tr>
                                    <td style="width: 100px; text-align: right;font-size: 13.67px">
                                        <t t-set="amount_by_group" t-value="doc.amount_by_group"/>
                                        <t t-if="amount_by_group and len(amount_by_group) &gt; 0 and len(amount_by_group[0]) &gt; 1">
                                            <t t-if="amount_by_group[0][1]">
                                                <t t-set="value" t-value="amount_by_group[0][1]"/>
                                                <t t-if="value is not None">
                                                    <span t-esc="'{:,.2f}'.format(float(value))"/>
                                                </t>
                                                <t t-else="">
                                                    <span>-</span>
                                                </t>
                                            </t>
                                            <t t-if="not amount_by_group[0][1]">
                                                <span>-</span>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span>-</span>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                      </div>
                      
                        <div class="row" style="margin-top: 5px; margin-bottom: 1mm;">
                            <table style="width: 94%; text-align: left;">
                                <tr>
                                    <td style="width: 30%; text-align: right;color: white">
                                       <span style="color: white">-</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <div class="row" style="margin-top: 15px; margin-bottom: 2mm; position: relative; top: -39px;">
                            <table style="width: 98%; text-align: right;">
                                <tr>
                                    <td style="width: 30%; text-align: right;font-size: 13.67px">
                                        <span t-esc="'{:,.2f}'.format(float(doc.amount_total))"/>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </div>

                <div class="row" style="margin-left: 70%; justify-content: flex-end; position: relative; top: -28px;">
                    <table style="width: 94%; text-align: right;">
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                              <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                  <t t-if="doc.billing_period_id">
                                      BL: <span t-field="doc.billing_period_id.name"/> 
                                  </t>
                                  <t t-if="not doc.billing_period_id">
                                      <span style="color: white">-</span>
                                  </t>
                              
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 0px; margin-right: 50px; text-align: right;">
                              <span style="color: white">-</span>
                            </td>
                            <td style="width: 250px;">
                                <t t-if="doc.billing_place_id">
                                    RE: <span t-field="doc.billing_place_id.name"/> 
                                </t>
                                <t t-if="not doc.billing_place_id">
                                    <span style="color: white">-</span>
                                </t>
                                  
                            </td>
                        </tr>
                    </table>
                </div>



               <div style="position: absolute; top: 245px; left: 420px;">
                    <span t-field="doc.name"/>
                </div>

                <!-- อยู่กับที่กลางหน้ากระดาษ -->
              <div style="position: absolute; top: 320px; left: 30%; width: 400px;text-align: center;">
                  <span t-field="doc.user_sale_agreement_employee.name"/><br/>
                  <!--<span t-field="doc.user_sale_agreement_employee.work_phone"/><br/>-->
                  <span t-field="doc.user_sale_agreement_employee.work_email"/>
              </div>

            </div>
        </div>

    </template>

</odoo>