<?xml version="1.0"?>
<odoo>
    <record id="view_picking_confirm_warehouse_form" model="ir.ui.view">
        <field name="name">stock.picking.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form" />
        <field name="arch" type="xml">
            <xpath expr="//button[@name='button_validate']" position="attributes">
                <attribute name="groups">hdc_confirm_warehouse.group_inventory</attribute>
                <attribute name="attrs">{'invisible': ['|','|', ('state', 'in', ('waiting','confirmed')), ('show_validate', '=', False),('hide_validate_btn','=',True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='origin']" position="after">
                <field name="type_of_operation" invisible="1"/>
                <field name="hide_validate_btn" invisible="1"/>
                <field name="hide_quantity_done" invisible="1"/>
                <field name="warehouse_status" readonly="1" widget="badge" 
                    decoration-success="warehouse_status in ('confirmed','done')" decoration-info="warehouse_status == 'warehouse'"
                    attrs="{'invisible': ['|',('type_of_operation', 'not in', ['incoming','internal','outgoing']),('addition_operation_types_code', '=', 'AO-06')]}"/>

                <!-- <field name="transfers_status" readonly="1" force_save="1" invisible="1"/> -->
                <field name="check_access_role" invisible="1"/>
                <field name="confirmed_warehouse_date" readonly="0" attrs="{'invisible': ['|',('type_of_operation', 'not in', ('incoming','outgoing')),('addition_operation_types_code', '=', 'AO-06')]}"/>
                <field name="user_confirm_warehouse_id" readonly="1" attrs="{'invisible': ['|',('type_of_operation', 'not in', ('incoming','outgoing')),('addition_operation_types_code', '=', 'AO-06')]}"/>
                <label for="warehouse_out_date" attrs="{'invisible': [('type_of_operation', '!=', 'internal')]}" />
                <div class="o_row" attrs="{'invisible': [('type_of_operation', '!=', 'internal')]}">
                    <field name="warehouse_out_date" class="oe_inline" readonly="0" force_save="1" />
                    <field name="user_warehouse_out_id" class="oe_inline" readonly="1"/>
                </div>
                <label for="warehouse_in_date" attrs="{'invisible': [('type_of_operation', '!=', 'internal')]}" />
                <div class="o_row" attrs="{'invisible': [('type_of_operation', '!=', 'internal')]}">
                    <field name="warehouse_in_date" class="oe_inline" readonly="0" force_save="1" />
                    <field name="user_warehouse_in_id" class="oe_inline" readonly="1"/>
                </div>
                <field name="validate_date" class="oe_inline" readonly="0" force_save="1" attrs="{'invisible': ['|',('type_of_operation', 'not in', ('incoming','outgoing')),('addition_operation_types_code', '=', 'AO-06')]}"/>
                <field name="validate_user_id" class="oe_inline" readonly="1" attrs="{'invisible': ['|',('type_of_operation', 'not in', ('incoming','outgoing')),('addition_operation_types_code', '=', 'AO-06')]}"/>
                <field name="inventory_status" readonly="1" widget="badge" 
                    decoration-success="inventory_status in ('confirmed','done')" 
                    decoration-info="inventory_status == 'progress'"
                    decoration-warning="inventory_status == 'waiting'"
                    attrs="{'invisible': ['|',('type_of_operation', 'not in', ['incoming','internal','outgoing']),('addition_operation_types_code', '=', 'AO-06')]}"/>
            </xpath>
            <xpath expr="//button[@name='button_validate']" position="before">
                <button string="Confirm" name="action_confirm_warehouse" groups="hdc_confirm_warehouse.group_warehouse" type="object" class="oe_highlight" attrs="{'invisible': ['|','|',('type_of_operation', 'not in', ('incoming','outgoing')),('state', '!=', 'assigned'),('warehouse_status','=','confirmed')]}"/>
                <button string="Transfer Out" name="action_confirm_warehouse_out" groups="hdc_confirm_warehouse.group_warehouse" type="object" class="oe_highlight" attrs="{'invisible': ['|','|',('type_of_operation', '!=', 'internal'),('state', '!=', 'assigned'),('warehouse_status','=','confirmed')]}"/>
            </xpath>
            <xpath expr="//field[@name='move_ids_without_package']/tree/field[@name='quantity_done']" position="before">
                <field name="qty_counted" attrs="{'column_invisible': ['|','|',('parent.addition_operation_types_code', '=', 'AO-06'),('parent.type_of_operation', 'not in', ('incoming','outgoing')),('parent.state', 'in', ['draft', 'waiting', 'confirmed'])], 'readonly': ['|',('parent.warehouse_status', '!=', 'warehouse'),('parent.state','!=','assigned')]}"/>
                <field name="transfers_qty" attrs="{'column_invisible': ['|',('parent.type_of_operation', '!=', 'internal'),('parent.state', 'in', ['draft', 'waiting', 'confirmed'])], 'readonly': ['|',('parent.warehouse_status','=','confirmed'),('parent.state','!=','assigned')]}"/>
            </xpath>
            <xpath expr="//field[@name='move_ids_without_package']/tree/field[@name='quantity_done']" position="attributes">
                <attribute name="attrs">{'column_invisible': [('parent.hide_quantity_done', '=', True)], 'readonly': [('is_quantity_done_editable', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='move_ids_without_package']/tree/button[@name='action_show_details']" position="attributes">
                <attribute name="groups">hdc_confirm_warehouse.group_inventory</attribute>
            </xpath>
        </field>
    </record>
    <record id="vpicktree_view_warehouse_confirm" model="ir.ui.view">
        <field name="name">stock.picking.warehouse.tree.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='state']" position="after">
                <field name="warehouse_status" widget="badge" decoration-success="warehouse_status in ('confirmed','done')" decoration-info="warehouse_status == 'warehouse'"/>
                <field name="inventory_status" widget="badge" 
                    decoration-success="inventory_status in ('confirmed','done')" 
                    decoration-info="inventory_status == 'progress'"
                    decoration-warning="inventory_status == 'waiting'"/>
            </xpath>
        </field>
    </record>



    <record id="view_picking_batch_confirm_warehouse_form" model="ir.ui.view">
        <field name="name">stock.picking.batch.form.inherit.confirm</field>
        <field name="model">stock.picking.batch</field>
        <field name="inherit_id" ref="stock_picking_batch.stock_picking_batch_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <button
                    name="action_confirm_warehouse_batch"
                    string="Confirm Warehouse"
                    attrs="{'invisible': ['|',('warehouse_status', 'in', ['confirmed','done','cancel']),('state','=','draft')]}"
                    class="btn-primary"
                    type="object"
                    groups="hdc_confirm_warehouse.group_receipt_confirm"
                />
                <!-- <button
                    name="create_vendor_bill"
                    string="Create Bill"
                    attrs="{'invisible': ['|','|',('bill_status', 'not in', ['nothing']),('state','!=','done'),('bill_ids', '!=', [])]}"
                    class="btn-primary"
                    type="object"
                /> -->
            </xpath>

            <!-- <xpath expr="//sheet/div[@class='oe_title']" position="before">
                 <field name="bill_ids" invisible="1" />
                <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" name="action_view_bills"
                                type="object" attrs="{'invisible': [('bill_ids', '=', [])]}" 
                                icon="fa-pencil-square-o" 
                        >
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value">
                                    <field name="bill_count" />
                                </span>
                                <span class="o_stat_text">Vendor Bills</span>
                            </div>
                        </button>
                    </div>
            </xpath> -->


            <xpath expr="//field[@name='scheduled_date']" position="after">
                <field name="hide_validate_btn" invisible="1"/>
                <field name="warehouse_status" widget="badge" 
                    decoration-success="warehouse_status in ('confirmed','done')"
                    decoration-info="warehouse_status == 'warehouse'"
                    decoration-muted="warehouse_status == 'cancel'"/>
                <field name="confirm_picking_date" />
                <field name="user_confirm_picking" />
                <field name="validation_picking_date" />
                <field name="user_validation_picking" />
                <field name="inventory_status" readonly="1" widget="badge" 
                    decoration-warning="inventory_status == 'waiting'"
                    decoration-info="inventory_status == 'progress'"
                    decoration-success="inventory_status == 'done'"
                    decoration-muted="warehouse_status == 'cancel'"/>
                <field name="bill_status" readonly="1" widget="badge" decoration-success="bill_status in ('biled')"/>
            </xpath>

            <button name="action_done" position="attributes">
                <attribute name="attrs">
                    {'invisible': [('hide_validate_btn', '=', True)]}
                </attribute>
                <attribute name="groups">hdc_confirm_warehouse.group_receipt_validate</attribute>
            </button>
            
            
        </field>
    </record>
<!-- 
    <record id="action_create_vendor_bill_from_batch" model="ir.actions.server">
        <field name="name">Create Bill</field>
        <field name="model_id" ref="stock_picking_batch.model_stock_picking_batch"/>
        <field name="binding_model_id" ref="stock_picking_batch.model_stock_picking_batch"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">
            if records:
                records.create_vendor_bill()
        </field>
    </record> -->
</odoo>
