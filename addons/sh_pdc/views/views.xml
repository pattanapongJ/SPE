<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <!--  Add Button for register PDC Payment -->
    <record id="sh_move_form_inherit" model="ir.ui.view">
        <field name="name">Sh move form Inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
						<button name="open_pdc_payment"
                                    class="oe_stat_button"
                                    type="object"
                                     icon="fa-credit-card"
                                    attrs="{'invisible':[('pdc_payment_count','=',0)]}">
                                    <field name="pdc_payment_count" widget="statinfo"  string="PDC Payments"/>
                            </button>
				</xpath>
				<xpath expr='//page[@name="other_info"]' position='after'>
					<page name='pdc_payment' string='PDC Payment' invisible="1">
						<field name='pdc_payment_ids'>
							<tree decoration-success="state =='done'" decoration-info="state == 'draft'"  decoration-danger="state == 'bounced'" decoration-muted="state == 'cancel'">
								<field name="currency_id" invisible="1"/>
								<field name="payment_date"/>
								<field name="name"/>
								<field name="journal_id"/>
								<field name="partner_id"/>
								<field name="payment_amount"/><field name="state"/>
							</tree>
							<form>
								<header>
				                  <button name="action_register" class="oe_highlight" states="draft" string="Register" type="object"/>
				                  <button name="action_returned" class="oe_highlight" states="registered" string="Return" type="object"/>
				                  <button name="action_deposited" class="oe_highlight" states="registered,returned,bounced" string="Deposit" type="object"/>
				                  <button name="action_bounced" class="oe_highlight" states="deposited" string="Bounce" type="object"/>
				                  <button name="action_done" class="oe_highlight" states="deposited" string="Done" type="object"/>
				                  <button name="action_cancel" class="oe_highlight" states="registered,returned,bounced" string="Cancel" type="object"/>
				                  
				                      <field name="state" widget="statusbar"/>
				                </header>
								<sheet>
								<div name="button_box" class="oe_button_box">
				                            <button name="open_attachments"
				                                    class="oe_stat_button"
				                                    icon="fa-cloud-upload"
				                                    type="object"
				                                    string="Attachments">
				                            </button>
				                             <button name="open_journal_items"
				                                    class="oe_stat_button"
				                                    icon="fa-list"
				                                    type="object"
				                                    string="Journal Items">
				                            </button>
				                             <button name="open_journal_entry"
				                                    class="oe_stat_button"
				                                    icon="fa-list"
				                                    type="object"
				                                    string="Journal Entry">
				                            </button>
				                   </div>
								
									<group>
										<group>
											<field name="name" readonly="1"/>
											<field name="payment_type" attrs="{'readonly':[('state','not in',['draft','bounced'])]}" widget="radio"/>
											<field name="currency_id" invisible="1"/>
											<field name="partner_id" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="payment_amount" widget="monetary" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="reference" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="journal_id" options="{'no_create':1,'no_create_edit':1}" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
										</group>
										<group>
											<field name="payment_date" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="due_date" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="memo" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="agent" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
											<field name="bank_id" attrs="{'readonly':[('state','not in',['draft','bounced'])]}"/>
										</group>
									</group>
									<notebook>
										<page string="Attachments">
											<field name="attachment_ids" widget="many2many_binary"/>
											<!-- <field name="attachment_ids" attrs="{'readonly':[('state','not in',['draft','bounced','registered','returned'])]}">
												<tree string="Attachments">
								                    <field name="name"/>
								                    <field name="type"/>
								                    <field name="company_id" groups="base.group_multi_company"/>
								                    <field name="create_uid"/>
								                    <field name="create_date"/>
								                </tree>
											</field> -->
										</page>
									</notebook>
								</sheet>
							</form>
						</field>
						
						  <group class="oe_subtotal_footer">
                                <field name="total_pdc_received"/>
                                <field name="total_pdc_pending" />
                                <field name="total_pdc_cancel" attrs="{'invisible':[('total_pdc_cancel','=',0.0)]}"/>
                                <field name="total_pdc_payment" class="oe_subtotal_footer_separator"/>
                            </group>
						
					</page>
				</xpath>
        </field>
    </record>
	<record id="view_sh_account_payment_inherit_form_print" model="ir.ui.view">
		<field name="name">sh.account.payment.form</field>
		<field name="model">account.payment</field>
		<field name="inherit_id" ref="l10n_th_tax_invoice.view_account_payment_form" />
		<field name="arch" type="xml">
			<xpath expr="//button[@name='unmark_as_sent']" position="after">
				<field name="regis_pdc" invisible="1"/> 
				
				<button name="action_open_pdc_wizard" string="Create PDC" type="object" class="oe_highlight" attrs="{'invisible': [('pdc_id', '!=', False)]}" />
				<button name="button_register_pdc" string="Registered PDC" type="object" attrs="{'invisible':['|','|',('state', 'not in', 'posted'), ('pdc_id', '=', False),('regis_pdc', '=', True)]}"/>
			</xpath>
			<xpath expr="//field[@name='move_id']" position="after">
				<field name="payment_check_type" invisible="1" />
				<field name="check_pdc_state" invisible="1"/>
				<field name="pdc_id" string="PDC No." 
					domain="[('state', '=', 'draft'), ('payment_type', '=', payment_check_type)]" 
					attrs="{'readonly':[('check_pdc_state','in',['registered','done'])]}"
				/>

				<!-- <field name="pdc_id" string="PDC No." domain="[('state', '=', 'draft'), ('payment_number', '=', False), ('payment_type', '=', payment_check_type),('partner_id', '=', partner_id)]" attrs="{'readonly':[('check_pdc_state','in',['registered','done'])]}"/> -->
			</xpath>
		</field>
	</record>

	<!-- PDC Journal Check Box Settings -->
    <record id="view_account_journal_form" model="ir.ui.view">
        <field name="name">account.journal.form</field>
        <field name="model">account.journal</field>
        <field name="inherit_id" ref="account.view_account_journal_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='journal_entries']" position="inside">
                 <group>
                    <group string="">
                        <field name="pdc_journal_checkbox"/>
                    </group>
                </group>
            </xpath>
        </field>
    </record>

	<!-- PDC Register Wizard Message -->
	<record id="view_pdc_wizard_form" model="ir.ui.view">
        <field name="name">register.pdc.wizard.form</field>
        <field name="model">register.pdc.wizard</field>
        <field name="arch" type="xml">
            <form string="PDC Wizard Message" version="14.0">
                <group>
					<div class="horizontal-align-center">
						<field name="message" readonly="1" invisible="1"/>
						<label for="message" string="PDC has been registered" class="form-group" style="font-size: 18px;"/>
					</div>
				</group>
                <footer>
                    <button string="OK" class="btn-secondary" special="cancel" style="float:right;"/>
                </footer>
            </form>
        </field>
    </record>


</odoo>
